# $.table( rows, cols, th0, doc? ): Table

创建一个包含指定行列数单元格的空表格（单元格无内容），或解析一个规范的表格元素（无单元格合并或拆分）。返回一个 `Table` 实例。

`Table` 类实例仅提供简单的表格操作（不支持单元格合并/拆分），另外也不支持单元格的内容操作，而需要由外部的 `.html()` 或 `.text()` 来实现。这让 `Table` 的实现简单并轻量。

> **注：**<br>
> 完整的表格编辑十分复杂（包括 `Undo/Redo`），需要一个单独的库或插件来实现。


## 参数

### rows: Number | Element

将要创建的表格的行数，或待解析封装的已经存在的表格元素。


### cols: Number

将要创建的表格的列数。注意：表格一旦创建，列数就不可修改（`Table` 不提供相关接口）。


### th0: Boolean

表格是否包含一个列表头，即首列是否为 `<th>` 单元格。


### doc: Document

新建表格元素所属的文档对象，可选。


### 返回值

一个 `Table` 类的实例。


## 示例

```js
let tbl = $.table(2, 3, true);
// <table>
//     <tbody>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>
```

向单元格中插入内容需要另外的操作，它们不在 `Table` 接口中提供。

```js
$.text( tbl.caption(), '这是表格的标题' );
// <table>
//     <caption>这是表格的标题</caption>
//     <tbody>...</tbody>
// </table>

let ths = $.find( 'th', tbl.element() );
// [
//     <th>, <th>
// ]
// 注：.$() 方法返回内部<table>元素的Collector封装。

$(ths).text( ['第一行', '第二行'] );
// <tr>
//     <th>第一行</th>
//     <td></td>
//     <td></td>
// </tr>
//     <th>第二行</th>
//     <td></td>
//     <td></td>
// </tr>


let tds = $.find( 'td', tbl.element() );
// [
//     <td>, <td>, <td>, <td>
// ]

$(tds).text( ['单元格11', '单元格12', '单元格21', '单元格22'] );
// <tr>
//     <th>第一行</th>
//     <td>单元格11</td>
//     <td>单元格12</td>
// </tr>
// <tr>
//     <th>第二行</th>
//     <td>单元格21</td>
//     <td>单元格22</td>
// </tr>
// 注：
// .text()接口的值可采用数组形式，与集合内成员按顺序一一对应。
```


## Table 接口

### Table( rows, cols, th0, doc? ): Table

构造函数，创建一个指定行列数的表格元素，返回一个 `Table` 实例。内部的 `<table>` 元素包含一个默认的 `<tbody>` 子结构，不含 `<thead>` 或 `<tfoot>`，因此注意行计数应去除表头/表脚的部分。


#### 参数

- `rows: Number` 表格的行数。
- `cols: Number` 表格的列数。
- `th0: Boolean` 首列是否为 `<th>` 单元格。
- `doc: Document` 所属文档对象，可选。

```js
let tbl = new Table(2, 3);
// <table>
//     <tbody>
//         <tr>
//             <td></td>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <td></td>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>
```


#### 返回值

一个 `Table` 类的实例。包含了下面十分简单的处理接口。


### .bodies( idx?, op? ): [Element] | Element | undefined

获取或删除表体（`<tbody>`）元素。仅在存在多个表体元素时才需要此接口，普通情形使用 `.body(...)` 更简捷。


#### 参数

- `idx: Number` 表体元素的序号（从0开始），可选。未传递值时视为获取全部表体元素。
- `op: null` 删除操作标识，可选。`idx` 无效时删除无效果（不会出错）。


#### 返回值

目标位置的表体元素或表体元素集（`Array`），如果目标位置无值，返回 `undefined`。


### .caption( op? ): Element | null

创建、获取或删除表标题（`<caption>`）元素。

> **注意：**
> 新建的表标题元素不会自动插入表格中（且是无条件创建的），插入需由用户自主决定。下面的 `<tbody>, <thead>, <tfoot>, <tr>` 等也遵循相同的原则。


#### 参数

- `op: true|null|undefined` 传递 `true` 时无条件创建一个表标题，传递 `null` 时移除表标题，否则获取已经存在的表标题（可能为 `null`）。


#### 返回值

新建的或原有的或删除的表标题元素，非新建时可能返回 `null`（本来就没有 `<caption>`）。


### .insertCaption( el ): Element

插入或替换原有的表标题。如果表格中已经存在 `<caption>` 则为替换，否则在前端插入 `el` 表标题元素。


#### 参数

- `el: Element` 表标题元素，应当由 `.caption(true)` 创建而来。


#### 返回值

即传入的实参表标题元素。


### .body( op? ): Element | undefined

表体元素（`<tbody>`）的新建，或首个表体元素的获取或删除。

与 `.bodies()` 接口稍有不同，除了新建表体元素外，此处仅针对表格内 **首个** 表体元素操作。


#### 参数

- `op: true|null|undefined` 传递 `true` 时无条件创建一个 `<tbody>` 元素，传递 `null` 时移除首个表体元素，否则获取首个表体元素（可能为 `undefined`）。


#### 返回值

一个新的 `<tbody>` 元素，或首个表体元素（不存在时返回 `undefined`）。


### .insertBody( el, idx? ): Element

插入表体元素。可以指定插入的下标位置，默认插入到表体元素集末尾（作为最后一个）。


#### 参数

- `el: Element` 表体元素，应当由 `.body(true)` 创建而来。
- `idx: Number` 待插入的位置下标（从0开始），支持负数从末尾算起。可选，无值或超出范围视为末尾（`-1`）。


#### 返回值

即传入的实参表体元素。


### .head( op? ): Element | null

表头元素（`<thead>`）的新建、获取或删除。


#### 参数

- `op: true|null|undefined` 传递 `true` 时无条件创建一个表头元素，传递 `null` 时移除表头元素（如果有），否则获取表头元素（可能为 `null`）。


#### 返回值

新建的或原有的或删除的表头（`<thead>`）元素，非新建时可能返回 `null`（本来没有）。


### .insertHead( el ): Element

插入或替换原有的表头元素。如果表格中已经存在 `<thead>` 则为替换，否则在合适的位置插入表头元素（`el`）。


#### 参数

- `el: Element` 表头元素，应当由 `.head(true)` 创建而来。


#### 返回值

即传入的实参表头元素。



### .foot( op? ): Element | null

表脚元素（`<tfoot>`）的新建、获取或删除。


#### 参数

- `op: true|null|undefined` 传递 `true` 时无条件创建一个表脚元素，传递 `null` 时移除表脚元素（如果有），否则获取表脚元素（可能为 `null`）。


#### 返回值

新建的或原有的或删除的表脚（`<tfoot>`）元素，非新建时可能返回 `null`（本来没有）。


### .insertFoot( el ): Element

插入或替换原有的表脚元素。如果表格中已经存在 `<tfoot>` 则为替换，否则在合适的位置插入表脚元素（`el`）。


#### 参数

- `el: Element` 表脚元素，应当由 `.foot(true)` 创建而来。


#### 返回值

即传入的实参表脚元素。


### .newTr( head? ): Element

创建一个表格行（`<tr>`）。表格行内包含了规范的单元格子元素序列。


#### 参数

- `head: Boolean` 创建的 `<tr>` 是否为表头内的行。可选。


#### 返回值

包含了合规单元格内容的表格行元素。


### .insertTr( tr, idx?, tsec? ): Element

将表格行（实参 `tr`）插入到指定的位置。


#### 参数

- `tr: Element` 表格行元素，应当由 `.newTr()` 创建而来。
- `idx: Number` 在表区域（`tsec`）内的位置下标，支持负数从末尾算起。
- `tsec: TableSection` 接受插入的表区域元素。可选，默认为针对整个表格。


#### 返回值

即传入的表格行实参（`tr`）元素。


### .removeTr( idx, tsec? ): Element | undefined

删除目标位置的表格行元素。


#### 参数

- `idx: Number` 在表区域（`tsec`）内的位置下标，支持负数从末尾算起。
- `tsec: TableSection` 表区域元素。可选，默认为针对整个表格。


#### 返回值

被删除的表格行元素，如果指定下标超出范围，则返回 `undefined`。


### .tr( idx, tsec? ): Element | null

获取目标位置的行元素（`<tr>`）。如果未指定 `tsec`，行计数针对整个表格。


#### 参数

- `idx: Number` 目标位置（从 `0` 开始），支持负值从末尾算起。
- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


#### 返回值

目标位置的行元素，无效的位置指定返回 `undefined`。


### .newColumn( vth? ): [Element]

创建一列单元格序列。


#### 参数

- `vth: Boolean` 是否为列表头（一列皆为 `<th>` 单元格），可选。


#### 返回值

符合表格列规格的单元格序列，数组的长度与表格的行数相同。


### .insertColumn( idx, cells ): [Element]

插入一列单元格。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。
- `cells: [Element]` 待插入的单元格序列，应当由 `.newColumn()` 创建而来。


#### 返回值

新插入的列单元格集（也即 `cells` 实参）。


### .removeColumn( idx ): Collector

删除目标位置列的单元格。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。


#### 返回值

被删除的列单元格集。


### .column( idx ): [Element]

获取目标位置的一列单元格序列。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。


#### 返回值

目标位置的列单元格集。超出范围的下标指定返回一个空数组。


### .rows( tsec? ): Number

返回表格目标区（`<thead>|<tbody>|<tfoot>`）的行数。未指定 `tsec` 时计数针对整个表格。


#### 参数

- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


### .cols(): Number

返回表格的列数。


### .vth(): Number | null

返回列头的位置值：`1` 表示在首列，`-1` 表示在末尾列。`null` 表示无列头。


### .element(): Element

返回原始的 `<table>` 表格元素。


## 示例

```js
let tbl = new $.Table(2, 3, true);
// <table>
//     <tbody>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>


tbl.head();  // null

tbl.insertHead( tbl.head(true) );
// <table>
//     <thead>
//         <tr>
//             <th></th>
//             <th></th>
//             <th></th>
//         </tr>
//     </thead>
//     <tbody>...</tbody>
// </table>


trs.children().flat()
// Collector [
//     <th>,
//     <th>,
//     <th>,
// ]

tbl.gets(0, 1).children().flat();
// 同上。

tbl.get(0);
// <tr>
//     <th></th>
//     <th></th>
//     <th></th>
// </tr>


tbl.foot(1).children().flat().text('FOOT');
// <tfoot>
//     <tr>
//         <th>FOOT</th>
//         <td>FOOT</td>
//         <td>FOOT</td>
//     </tr>
// </tfoot>
// 注：
// text() 单个值时对全部的成员作相同填充。
// 注意 .children() 之后的 .flat() 调用！
```
