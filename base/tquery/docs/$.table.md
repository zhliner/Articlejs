# $.table( rows, cols, th0, doc? ): Table

创建一个包含指定行列数单元格的空表格（单元格无内容），或解析一个规范的表格元素（无单元格合并或拆分）。返回一个 `Table` 实例。

`Table` 类实例仅提供简单的表格操作（不支持单元格合并/拆分），另外也不支持单元格的内容操作，而需要由外部的 `.html()` 或 `.text()` 来实现。这让 `Table` 的实现简单并轻量。

> **注：**<br>
> 完整的表格编辑十分复杂（包括 `Undo/Redo`），需要一个单独的库或插件来实现。


## 参数

### rows: Number | Element

将要创建的表格的行数，或待解析封装的已经存在的表格元素。


### cols: Number

将要创建的表格的列数。注意：表格一旦创建，列数就不可修改（`Table` 不提供相关接口）。


### th0: Boolean

表格是否包含一个列表头，即首列是否为 `<th>` 单元格。


### doc: Document

新建表格元素所属的文档对象，可选。


### 返回值

一个 `Table` 类的实例。


## 示例

```js
let tbl = $.table(2, 3, true);
// <table>
//     <tbody>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>
```

向单元格中插入内容需要另外的操作，它们不在 `Table` 接口中提供。

```js
$.text( tbl.caption(), '这是表格的标题' );
// <table>
//     <caption>这是表格的标题</caption>
//     <tbody>...</tbody>
// </table>

let ths = $.find( 'th', tbl.element() );
// [
//     <th>, <th>
// ]
// 注：.$() 方法返回内部<table>元素的Collector封装。

$(ths).text( ['第一行', '第二行'] );
// <tr>
//     <th>第一行</th>
//     <td></td>
//     <td></td>
// </tr>
//     <th>第二行</th>
//     <td></td>
//     <td></td>
// </tr>


let tds = $.find( 'td', tbl.element() );
// [
//     <td>, <td>, <td>, <td>
// ]

$(tds).text( ['单元格11', '单元格12', '单元格21', '单元格22'] );
// <tr>
//     <th>第一行</th>
//     <td>单元格11</td>
//     <td>单元格12</td>
// </tr>
// <tr>
//     <th>第二行</th>
//     <td>单元格21</td>
//     <td>单元格22</td>
// </tr>
// 注：
// .text()接口的值可采用数组形式，与集合内成员按顺序一一对应。
```


## Table 接口

### Table( rows, cols, th0, doc? ): Table

构造函数，创建一个指定行列数的表格元素，返回一个 `Table` 实例。内部的 `<table>` 元素包含一个默认的 `<tbody>` 子结构，不含 `<thead>` 或 `<tfoot>`，因此注意行计数应去除表头/表脚的部分。


#### 参数

- `rows: Number` 表格的行数。
- `cols: Number` 表格的列数。
- `th0: Boolean` 首列是否为 `<th>` 单元格。
- `doc: Document` 所属文档对象，可选。

```js
let tbl = new Table(2, 3);
// <table>
//     <tbody>
//         <tr>
//             <td></td>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <td></td>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>
```


#### 返回值

一个 `Table` 类的实例。包含了下面十分简单的处理接口。


### .caption( op ): Element | null

获取或删除表标题（`<caption>`）。获取时如果表标题元素不存在则新建一个。


#### 参数

- `op: null|undefined` 传递 `null` 时表示移除表标题元素，否则为获取。


#### 返回值

原有或新建或删除的表标题元素，删除时可能返回 `null`（本来就没有 `<caption>`）。


### .newBody(): Element

创建一个新的 `<tbody>` 元素插入到所有 `<tbody>` 元素之后并返回该元素。返回值需配合 `.body()` 接口使用。

> **注：**<br>
> 多个 `<tbody>` 可模拟表格的分区效果，并可能提高性能。


### .delBody( idx ): Element

删除 `idx` 位置的 `<tbody>` 元素。`idx` 指 `<tbody>` 在 `table:tBodies` 中的位置。

> **注：**<br>
> 一个表格中通常只有一个 `<tbody>`，本接口仅在表格中包含多个 `<tbody>` 时才有用。


#### 参数

- `idx: Number` 目标元素的位置下标。可选，默认为 `0`。


#### 返回值

被删除的 `<tbody>` 元素。


### .body( rows, idx?, tsec? ): [Element] | Collector

获取表体元素（`<tbody>`）集，或在 `tsec` 内添加指定数量的表格行。新插入的行元素包含合法数量的空单元格。


#### 参数

- `rows: Number` 新插入的行数。可选，默认返回表体元素集（`Array`）。
- `idx: Number` 新行插入的位置，支持负数从末尾算起。可选，默认或 `null` 值表示插入到末尾之后。
- `tsec: Element` 插入到的目标容器。可选，默认为表格内首个 `<tbody>` 元素。


#### 返回值

表格内的表体元素（`<tbody>`）集或新插入的 `<tr>` 元素集的 `Collector` 封装。


### .head( rows, idx? ): Element | Collector

获取或删除 `<thead>` 元素，或者在 `<thead>` 内插入表格行（无 `<thead>` 时会自动创建）。插入新行时全部为 `<th>` 空单元格，保持列数合法。

> **注：**<br>
> 通常情况下，表头内只有一行，但这不是必须的。


#### 参数

- `rows: Number|null` 新插入的行数或移除表头标记（`null`）。可选，无参数调用返回表头元素。
- `idx: Number` 新行插入的位置，支持负数从末尾算起。可选，无值（或 `null`）表示插入到末尾。


#### 返回值

表头元素（`<thead>`）或新插入行元素集的 `Collector` 封装。


### .foot( idx, rows? ): Element | Collector

获取或删除 `<tfoot>` 元素，或者在 `<tfoot>` 内插入表格行（无 `<tfoot>` 时会自动创建）。每行包含合法数量的空单元格，首列可能为 `<th>`，视原始状态而定。


#### 参数

- `rows: Number|null` 新插入的行数或移除表脚标记（`null`）。可选，无参数调用返回表脚元素。
- `idx: Number` 新行插入的位置，支持负数从末尾算起。可选，无值（或 `null`）表示插入到末尾。


#### 返回值

表脚元素（`<tfoot>`）或新插入行元素集的 `Collector` 封装。


### .get( idx, tsec? ): Element | null

获取目标位置的行元素（`<tr>`）。如果未指定 `tsec`，行计数针对整个表格。


#### 参数

- `idx: Number` 目标位置（从 `0` 开始），支持负值从末尾算起。
- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


#### 返回值

目标位置的行元素，无效的位置指定返回 `null`。


### .gets( idx, count, tsec? ): Collector

获取目标位置及之后的行元素集，表格行计数针对 `tsec`，未指定时针对整个表格。


#### 参数

- `idx: Number` 起始位置（从 `0` 开始），支持负值从末尾算起。
- `count: Number` 想要获取的行数，`null|undefined` 表示目标位置之后的全部行。可选。
- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


#### 返回值

目标行元素集的 `Collector` 封装，无效的位置指定返回一个空集。


### .remove( idx, tsec? ): Element

删除目标位置的表格行 `<tr>` 元素，未指定 `tsec` 时行计数针对整个表格。


#### 参数

- `idx: Number` 目标位置（从 `0` 开始），支持负值从末尾算起。
- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


#### 返回值

删除的目标行 `<tr>` 元素，无效的位置指定返回 `null`。


### .removes( idx, count, tsec? ): Collector

删除目标位置及之后多个表格行，行计数针对 `tsec`，未指定 `tsec` 时针对整个表格（`<thead>+<tbody>+<tfoot>`）。


#### 参数

- `idx: Number` 起始位置（从 `0` 开始），支持负值从末尾算起。
- `count: Number` 准备删除的行数，超出剩余行数时取剩余行数。`null|undefined` 表示起始位置之后全部的行。
- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`）。


#### 返回值

删除的行元素集的 `Collector` 封装，无效的位置指定返回一个空集。


### .insertColumn( idx ): Collector

插入一列单元格。新的单元格类型（`<td>` 或 `<th>`）与参考单元格相同。默认为向前插入，新的列会占据原参考列的位置。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。可选，若未传递或为 `null` 表示插入到末尾之后。


#### 返回值

新插入的列单元格集。


### .insertColumns( cols, idx ): Collector

插入多列单元格。新的单元格类型与参考单元格相同，在参考列之前插入。


#### 参数

- `cols: Number` 新插入的列数。
- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。可选，若未传递或为 `null` 表示插入到末尾之后。


#### 返回值

新插入的行单元格段（连续单元格数组）的集合（`Collector` 封装）。**注意**：即便只是插入一列，返回集合中的成员也是数组（段长为1）。


### .removeColumn( idx ): Collector

删除目标位置列的单元格。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。


#### 返回值

被删除的列单元格集。


### .removeColumns( idx, cols ): Collector

删除目标位置连续多个列的单元格。


#### 参数

- `idx: Number` 位置下标（从 `0` 开始），支持负值从末尾算起。
- `cols: Number` 将要删除的列数。若未传入值或为 `null` 表示删除到末尾全部。


#### 返回值

被删除的行单元格段（连续单元格数组）的集合（`Collector`）。若未实际删除内容（如 `idx` 无效），返回集合的成员将全部为空数组。


### .rows( tsec? ): Number

返回表格目标区（`<thead>|<tbody>|<tfoot>`）的行数。未指定 `tsec` 时计数针对整个表格。


#### 参数

- `tsec: Element` 目标表格区（TableSection: `tBody|tHead|tFoot`），可选。


### .columns(): Number

返回表格的列数。


### .hasVth(): Boolean

返回表格是否包含首列表头（首列为 `<th>`）。


### .element(): Element

返回原始的 `<table>` 表格元素。


### Table.proxyGetter( getter ): void

这是一个静态方法，用于在 `Table` 接口中嵌入Get代理。这是全局性的，当嵌入了代理后，`new Table(...)` 会返回一个代理对象，该代理对象的Get行为受 `getter` 控制。


#### 参数

- `getter: Function` Get代理函数，接口：`function( meth:String, origin:Table ): Function`。

`getter` 需要返回一个与目标方法（`meth`）接口相同的函数，这个函数通常需要记住它所代理的原始 `Table` 实例（`origin`）。


## 示例

```js
let tbl = new $.Table(2, 3, true);
// <table>
//     <tbody>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//         <tr>
//             <th></th>
//             <td></td>
//             <td></td>
//         </tr>
//     </tbody>
// </table>


tbl.head();  // null

let trs = tbl.head(1);
// <table>
//     <thead>
//         <tr>
//             <th></th>
//             <th></th>
//             <th></th>
//         </tr>
//     </thead>
//     <tbody>...</tbody>
// </table>


trs.children().flat()
// Collector [
//     <th>,
//     <th>,
//     <th>,
// ]

tbl.gets(0, 1).children().flat();
// 同上。

tbl.get(0);
// <tr>
//     <th></th>
//     <th></th>
//     <th></th>
// </tr>


tbl.foot(1).children().flat().text('FOOT');
// <tfoot>
//     <tr>
//         <th>FOOT</th>
//         <td>FOOT</td>
//         <td>FOOT</td>
//     </tr>
// </tfoot>
// 注：
// text() 单个值时对全部的成员作相同填充。
// 注意 .children() 之后的 .flat() 调用！
```
