# 文章内容的规范化结构

文章的内容最多分为五个层级：**章**、**节**、**区**、**段**、**末**，每一层级对应一个 `<section>`，其中首个元素为标题（`<h2>` ~ `<h6>`）。**章**的标题为 `<h2>`，**节**的标题为 `<h3>`，其余类推。`<h1>` 用于文章自身的主标题，不作为内容层次结构里的组成。

文章用 `<article>` 元素包含，是全部内容结构的根元素。

本设计试图规范化大部分文章的内容结构，让样式文件可以共享。精美的样式能够提高阅读体验，共享的样式则可以让作者去除负担，专注于内容。


## 内容的结构

逐级嵌套的结构按标题号递减（数字递增），逻辑上是越来越细化的片区。本设计借鉴了Markdown文档按标题折叠的逻辑，因此也便于从Markdown文档直接简单转换过来。

> **注：**<br>
> 根据使用经验，这种规范的结构有助于合理地组织内容，实现更清晰的表达。

重构的层次结构如下。


### 层次图

```html
<article> <h1></h1>                             <!-- 根容器/主标题 -->
    <header role="summary"></header>            <!-- 摘要 -->
    <nav role="toc" class="toc"></nav>          <!-- 目录 -->
    <header></header>                           <!-- 导言 -->
    <section> <h2></h2>                         <!-- 章片区/标题。第一层 <section> -->
        <header></header>                       <!-- 导言 -->
        <section> <h3></h3>                     <!-- 节片区/标题。第二层 <section> -->
            <header></header>                   <!-- 导言 -->
            <section> <h4></h4>                 <!-- 区片区/标题。第三层 <section> -->
                <header></header>               <!-- 导言 -->
                <section> <h5></h5>             <!-- 段片区/标题。第四层 <section> -->
                    <header></header>           <!-- 导言 -->
                    <section> <h6></h6>         <!-- 末片区/标题。第五层 <section> -->
                        <section role="content" class="content">
                            [块单元内容]...      <!-- 内容/正文 -->
                        </section>
                    </section></section></section></section></section>
    <hr />                                      <!-- 章间隔 -->
    <ul role="seealso"></ul>                    <!-- 另参见 -->
    <ol role="references"></ol>                 <!-- 文献参考 -->
</article>
```

**解析逻辑：**

1. 在文本格式的 `markdown` 中，每一级标题之后的内容即为该标题所属 `<section>` 的内容。
2. 在内容之中可以包含层级更低的标题，如果出现更低层级的下级标题，在首个下级标题之前的内容被视为 `<header>`。
3. 如果内容中已经没有下级标题，则视为正文部分，由 `<section role="content">` 包含，它被称为 `正文区`。
4. 如果下级标题不是顺次递减而是跨级，则也被视为正文区，但内部子标题继续解析。这违反了标准的层次结构，通常是内容组织不够合理的表现。
5. 因此，除了正文区外，一个层级中最多只会包含3种单元：标题（`h2-h6`）、导言（`header`）、一个或多个下级 `<section>`。

> **注：**<br>
> 对于缺乏明确标签表达的内容逻辑，采用相似用途的标签和 `role` 属性来定义，如 `<nav role="toc">` 表示目录。<br>
> 在实际的 `HTML` 文档里会添加一个与 `role` 同值的 `class` 属性，便于 `CSS` 定位引用。<br>


## 内容成员

### 块单元

块单元会占据单独的一行，在CSS中的显示属性是 `display:block`。块单元又分为两种，一种是需要包含其它元素的**容器类**，一种是可以直接包含文本内容的**内容类**。


#### 容器类

内部不能直接包含行内元素（如文本、图片等），如果没有标准的内部元素，则必须采用通用的 `<p>` 段落容纳。

```html
<header role="summary"></header>    <!-- 摘要 -->
<nav role="toc"></nav>              <!-- 目录 -->
<header></header>                   <!-- 导言 -->
<section></section>                 <!-- 片区 -->
<section role="content"></section>  <!-- 终端内容区 -->
<ul></ul>                           <!-- 无序列表 -->
<ul role="seealso"></ul>            <!-- 另参见 -->
<ol></ol>                           <!-- 有序列表 -->
<ol role="cascade"></ol>            <!-- 多级编号列表 -->
<ol role="codes"></ol>              <!-- 代码表 -->
<ol role="references"></ol>         <!-- 文献参考 -->
<dl></dl>                           <!-- 定义列表 -->
<table></table>                     <!-- 表格 -->
<figure></figure>                   <!-- 插图 -->
<blockquote></blockquote>           <!-- 引用块 -->
<aside></aside>                     <!-- 批注 -->
<details></details>                 <!-- 详细内容 -->
<footer></footer>                   <!-- 尾注 -->
<pre><code></code></pre>            <!-- 代码块 -->
```


#### 内容类

```html
<hr />                      <!-- 线条 -->
<p></p>                     <!-- 段落，通用内容容器 -->
<address></address>         <!-- 地址信息 -->
<pre></pre>                 <!-- 预排版 -->
```


### 行内单元

只能被包含在内容类块单元里，如：`<p>`、`<address>` 等。代码块 `<code role="block">` 内的行内单元有固定的规则。

```html
<img />                     <!-- 图片 -->
<audio></audio>             <!-- 音频，子元素限定 -->
<video></video>             <!-- 视频，子元素限定 -->
<picture></picture>         <!-- 图片，子元素限定 -->
<a></a>                     <!-- 链接 -->
<strong></strong>           <!-- 重点 -->
<em></em>                   <!-- 强调 -->
<q></q>                     <!-- 短引用 -->
<abbr></abbr>               <!-- 缩写 -->
<cite></cite>               <!-- 来源 -->
<small></small>             <!-- 注脚 -->
<time></time>               <!-- 时间 -->
<del></del>                 <!-- 删除 -->
<ins></ins>                 <!-- 插入 -->
<sub></sub>                 <!-- 下标 -->
<sup></sup>                 <!-- 上标 -->
<mark></mark>               <!-- 标记 -->
<code></code>               <!-- 代码 -->
<code role="orz"></code>    <!-- 表情 -->
<ruby></ruby>               <!-- 注音，内含：<rt><rp> -->
<dfn></dfn>                 <!-- 定义 -->
<samp></samp>               <!-- 样本 -->
<kbd></kbd>                 <!-- 键盘字 -->
<s></s>                     <!-- 失效 -->
<u></u>                     <!-- 注记 -->
<var></var>                 <!-- 变量 -->
<bdo></bdo>                 <!-- 文本方向 -->
<meter></meter>             <!-- 度量 -->
<b>                         <!-- 粗体，主要用于代码块内的着色包装 -->
<i>                         <!-- 斜体，主要用于图标占位（CSS背景方式） -->
```


## 单元结构

### 原生结构

#### 导言/前言

```html
<header>
    <p></p> ...
</header>
```

#### 片区

```html
<section>
    <h2> ~ <h6>
    <header></header> <!-- 可选 -->
    <section></section>
</section>
```

#### 无序列表

```html
<ul>
    <li></li>
</ul>
```

#### 有序列表

```html
<ol>
    <li></li>
</ol>
```

#### 定义列表

```html
<dl>
    <dt></dt>
    <dd></dd>
</dl>
```

#### 表格

```html
<table>
    <caption></caption>
    <thead> <!-- 可选 -->
        <tr><td></td></tr>
    </thead>
    <tbody>
        <tr><td></td></tr>
    </tbody>
    <tfoot> <!-- 可选-->
        <tr><td></td></tr>
    </tfoot>
</table>
```

#### 插图

```html
<figure>
    <p><img /><p>
    <figcaption></figcaption>
</figure>
```

#### 详细内容

```html
<details>
    <summary></summary>
    <section role="content"></section>
</details>
```

#### 引用块

```html
<blockquote>
    <h4></h4> <!-- 可选 -->
    <p><p> ...
</blockquote>
```

#### 批注

```html
<aside>
    <h4></h4> <!-- 可选 -->
    <p><p> ...
</aside>
```

#### 尾注

```html
<footer>
    <p><p> ...
</footer>
```

#### 代码块

```html
<pre><!-- 容许简单换行 -->
<code data-lang="xx"> ...<b></b>...
</code><pre> <!-- 末尾应当紧跟 -->
```

#### 注音

```html
<ruby>
    漢 <rt> ㄏㄢˋ </rt>
</ruby>
```


### 定制结构

#### 摘要

```html
<header role="summary" class="summary">
    <h3>摘 要</h3>
    <p></p> ...
</header>
```

#### 目录

```html
<nav role="toc" class="toc">
    <h4></h4>
    <ol role="cascade" class="cascade">
        <li><a href="#..."></a></li>
    </ol>
</nav>
```

#### 终端内容区

```html
<section role="content" class="content">
    [块单元内容]... <!-- 不含其它片区<section> -->
</section>
```

#### 多级编号列表

```html
<ol role="cascade" class="cascade">
    <li></li> <!-- 由CSS表达序号规则 -->
    <li> ...
        <ol>
            <li></li>
        </ol>
    </li>
</ol>
```

#### 代码表

```html
<ol role="codes" class="codes">
    <li><code data-lang="xx"> <!-- 根封装 -->
        ...<b></b>... <!-- 代码内容，<b>着色封装 -->
    </code></li>
    <li><code data-lang="xx"> ... </code></li>
</ol>
```

**注**：所有代码的data-lang属性仅设置在 `<code>` 元素上。


## 代码着色

### 封装规则

考虑简单性，代码内的高亮着色采用 `<b>` 元素封装，通过 `class` 类名区分。所有 `<b>` 元素只会处于同一层级（`<code>` 直接子元素），没有嵌套。

基本类名定义如下：

```css
b.cmt   /* comments */
b.str   /* string */
b.kws   /* keywords */
b.tag   /* tag-name */
b.slr   /* selector */
b.atn   /* attribute-name */
b.atv   /* attribute-value */
b.fun   /* function-work */
b.typ   /* data-type */
b.imp   /* important */
b.doc   /* <!DOCTYPE...> */
b.cdt   /* <![CDATA[...]]> */
b.rex   /* js-RegExp */
b.non   /* invalid */
```

### 示例

#### 源码1（代码块）

```html
<pre>
<code data-lang="go"><b class="cmt">// prints its command-line arguments.</b>
<b class="kws">package</b> main

<b class="kws">import</b> (
    <b class="str">"fmt"</b>
    <b class="str">"os"</b>
)

<b class="kws">func</b> main() {
    <b class="kws">var</b> s, sep <b class="typ">string</b>
    <b class="kws">for</b> i := 1; i &lt; <b class="fun">len</b>(os.Args); i++ {
        s += sep + os.Args[i]
        sep = <b class="str">" "</b>
    }
    fmt.Println(s)
}</code></pre>
```

#### 效果

```go
// Echo1 prints its command-line arguments.
package main

import (
    "fmt"
    "os"
)

func main() {
    var s, sep string
    for i := 1; i < len(os.Args); i++ {
        s += sep + os.Args[i]
        sep = " "
    }
    fmt.Println(s)
}
```

#### 源码2（代码表）

```html
<ol role="codes" class="codes">
    <li><code data-lang="go"><b class="kws">package</b> main</code></li>
    <li><code data-lang="go"><b class="kws">import</b> <b class="str">"fmt"</b></code></li>
    <li><code data-lang="go"><b class="kws">func</b> main() {</code></li>
    <li><code data-lang="go">    fmt.Println(<b class="str">"Hello, 世界"</b>) <b class="cmt">// 通过导入的 fmt 包，执行 Println 函数向控制台打印消息。</b></code></li>
    <li><code data-lang="go">}</code></li>
    <li><code data-lang="go"><b class="kws">type</b> MapSort <b class="kws">struct</b> {</code></li>
    <li><code data-lang="go">    m <b class="kws">map</b>[<b class="typ">string</b>]<b class="typ">int</b></code></li>
    <li><code data-lang="go">    s []<b class="typ">string</b></code></li>
    <li><code data-lang="go">}</code></li>
</ol>
```

#### 效果

```go
package main
import "fmt"
func main() {
    fmt.Println("Hello, 世界") // 通过导入的 fmt 包，执行 Println 函数向控制台打印消息。这是一个长行。
}
type MapSort struct {
    m map[string]int
    s []string
}
```

**注**：html页面中实际会显示行号。
