<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>编辑器操作手册</title>
<link rel="stylesheet" href="../styles/example/main.css" />
<link rel="stylesheet" href="../styles/example/codes.css" />
<link rel="stylesheet" href="../base/tpb/default.css" />
<script src="../base/tquery/tquery.min.js"></script>
<style>
    body {
        margin: 0;
    }
    main {
        width: 800px;
        margin-left: 21em;
    }
</style>
<script type="module" async>
    import { Tpb } from "../base/tpb/tpb.esm.js";
    // 大纲导航：
    // 单击链接条目定位到目标章节。
    Tpb.build(
        document.querySelector('nav'),
        { on: "click(a)|evo(2) paths('nav[role=toc]', 'li') str('>section:nth-of-type(', ')') join str('/', '>h2') $('article') pop $(_1) intoView" }
    );
    // 列表滚动隐显
    // 单击目录标题条子表折叠
    Tpb.build(
        document.querySelector('nav>ol'),
        {
            on: "mouseenter|('auto'); mouseleave|('hidden'); click(~h5)|evo(2) parent fold(2)",
            to: "|css('overflow-y'); |css('overflow-y')"
        }
    )
</script>
</head>
<body>
    <main class="content">
        <h1>编辑操作</h1>
        <nav role="toc">
            <h4>目录</h4>
            <ol role="cascade">
                <li><a>全局热键</a></li>
                <li>
                    <h5><a>普通模式</a></h5>
                    <ol>
                        <li>
                            <h5><a>焦点元素</a></h5>
                            <ol>
                                <li><a>焦点移动</a></li>
                                <li><a>附：顶元素</a></li>
                            </ol>
                        </li>
                        <li>
                            <h5><a>元素选取</a></h5>
                            <ol>
                                <li><a>鼠标点选</a></li>
                                <li><a>按键选取</a></li>
                                <li><a>选取扩展</a></li>
                                <li><a>虚焦点支持</a></li>
                                <li><a>路径辅助选取</a></li>
                                <li><a>选取集排序</a></li>
                            </ol>
                        </li>
                        <li>
                            <h5><a>编辑操作</a></h5>
                            <ol>
                                <li><a>普通编辑</a></li>
                                <li><a>移动与缩进</a></li>
                                <li><a>进入微编辑</a></li>
                                <li><a>定位移动</a></li>
                                <li><a>复制和粘贴事件</a></li>
                            </ol>
                        </li>
                        <li><a>杂项功能</a></li>
                        <li><a>格式刷</a></li>
                    </ol>
                </li>
                <li>
                    <h5><a>录入面板</a></h5>
                    <ol>
                        <li>
                            <h5><a>快捷键</a></h5>
                            <ol>
                                <li><a>文本框&lt;textarea&gt;</a></li>
                                <li><a>表格单元&lt;th|td&gt;</a></li>
                                <li><a>代码框&lt;pre._code&gt;</a></li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li><a>修订模式</a></li>
                <li><a>属性框</a></li>
                <li>
                    <h5><a>命令行</a></h5>
                    <ol>
                        <li><a>选取（&gt;）</a></li>
                        <li><a>过滤（|）</a></li>
                        <li><a>搜索（/）</a></li>
                        <li><a>命令（:）</a></li>
                        <li><a>计算（=）</a></li>
                    </ol>
                </li>
                <li>
                    <h5><a>其它</a></h5>
                    <ol>
                        <li><a>表格的容错编辑</a></li>
                        <li><a>兼容性依赖</a></li>
                    </ol>
                </li>
            </ol>
        </nav>
        <article>
            <header>
                <p>与常见的编辑器不同，本编辑器有<strong>两种</strong>模式：</p>
                <ol>
                    <li><strong>普通模式</strong>。键盘友好，用户可以通过快捷键（通常就是一个字符键）执行各种操作，如：复制、移动、删除、章节缩进、本地保存、源码导出、撤销或重做等。同时，这也是从下方<strong>主面板区</strong>插入各种内容的模式。</li>
                    <li><strong>修订模式</strong>。对录入的内容作小量修改时使用，此时回车键被严格限制，以兼容不同浏览器对<code>contenteditable</code>元素的<kbd>Enter</kbd>行为。该模式有时也称为<strong>微编辑</strong>模式。考虑便捷性，该模式下也支持创建<em>同类或逻辑新行</em>的能力。</li>
                </ol>
                <p>进入<em>修订模式</em>很简单：选中目标元素，键入热键<kbd>M</kbd>，或右击鼠标打开上下文菜单，点选<em>修改</em>条目进入。</p>
            </header>
            <section role="s1">
                <h2>全局热键</h2>
                <p>本编辑器的操作设计借鉴于大名鼎鼎的<strong>Vim</strong>，普通模式下通过<strong>热键</strong>完成大部分操作，内容录入主要从下方主面板上的内容标签页实现。</p>
                <p role="note"><strong>注记</strong>：<br />要让一个普通的字符按键起作用，需要编辑器区域拥有<em>节点焦点</em>，以便让DOM节点树可以监听<em>按键事件</em>。</p>
                <p>编辑器有两个<em>聚焦区域</em>：</p>
                <ol>
                    <li><strong>编辑器</strong>。即编辑器自身整个界面（<em>全局</em>），单击编辑器任意位置即可。</li>
                    <li><strong>内容区</strong>。显示文章内容的中间区域。部分与文章内容紧密相关的操作需要此处聚焦。单击内容区任意元素或顶部的工具栏、或者按压全局热键<kbd>F8</kbd>也可以完成。</li>
                </ol>
                <p>当全局区域聚焦时（编辑器载入后自动完成），<strong>全局热键</strong>即可使用，当内容区聚焦时，内容区热键即有效。如果内容区的热键没有覆盖全局热键，内容区聚焦也同样就是全局聚焦。</p>
                <p>几个基本的全局热键如下：</p>
                <ul>
                    <li><kbd>F2</kbd>：左侧大纲面板<em>隐显</em>切换。</li>
                    <li><kbd>F3</kbd>：下方功能区主面板<em>隐显</em>切换。</li>
                    <li><kbd>F4</kbd>：右侧帮助面板<em>隐显</em>切换。</li>
                    <li><kbd>F6</kbd>：内容区底部焦点元素DOM路径提示栏<em>隐显</em>切换。</li>
                    <li><kbd>F7</kbd>：打开插件对话框（按<kbd>ESC</kbd>键可取消显示）。</li>
                    <li><kbd>F8</kbd>：内容区聚焦。</li>
                    <li><kbd>F9</kbd>：当前在显主面板（大纲、功能区、帮助）状态切换，方便用户充分预览内容区。</li>
                    <li><kbd>F10</kbd>：当前窗口最大化切换。</li>
                    <li><kbd>ESC</kbd>：各种取消。支持<code>选取集</code>、<code>上下文菜单</code>、<code>内联创建菜单</code>、<code>模态框</code>、<code>修订模式</code>、<code>前置数字</code>设置、<code>录入框平铺</code>等取消。<em><strong>注意</strong>：选取集取消会进入编辑历史栈（可撤销）。</em></li>
                </ul>
            </section>
            <section role="s1">
                <h2>普通模式</h2>
                <header>
                    <p>编辑器初始的常规状态即为<em>普通模式</em>。此时无法对文本进行编辑，但可以对内容进行各种控制。</p>
                    <ul>
                        <li><strong>选取</strong>：鼠标单击选中目标元素，按 <kbd>Ctrl</kbd> 键单击可多选或切换选取。另外还有一些<em>扩展选取</em>的快捷方式。被选中的多个目标元素称为<strong>选取集</strong>，它们是接下来各种操作的目标对象。</li>
                        <li><strong>移动</strong>：将选取集元素移动到焦点元素之前、之后或内部。如果源元素不是目标位置合法的类型，会自动转换。平级移动非常简单（<kbd>Alt+↑</kbd> 或 <kbd>Alt+↓</kbd>），也不需要转换。</li>
                        <li><strong>克隆</strong>：将选取集元素克隆并插入到焦点元素之前、之后或内部，位置不合法时也会自动转换。原地克隆也很简单，键入热键<kbd>C</kbd>即可，同时也支持<em>前置数字</em>指定克隆的份数。</li>
                        <li><strong>删除</strong>：大部分元素可以按<kbd>Delete</kbd>键直接删除，但拥有固定结构（如表格）的内部元素不可以。删除操作会智能判断目标类型，不能直接删除的只会移除其内容（而不是目标本身）。当然，你也可以<strong>强制删除</strong>它。</li>
                        <li><strong>缩进</strong>：仅适用章节片区。对选中的章节单元进行<em>升级</em>或<em>降级</em>。</li>
                        <li><strong>录入</strong>：从下方主面板的内容标签页里可以录入各种内容单元，这也是编辑器主要的内容导入方式。内容单元有自己的结构逻辑，在什么位置可以插入什么单元，会在左侧的条目选单上体现。</li>
                        <li><strong>转换</strong>：对特定类型的单元可以进行类型转换，比如将多个段落转换为列表、无序列表转为有序列表等。选中一个或多个同类目标，右击弹出<em>上下文菜单</em>即可找到转换<em>子菜单</em>。</li>
                        <li><strong>创建</strong>：在一个文本行上用鼠标<strong>划选</strong>后，会弹出内联单元创建菜单，单击目标条目或热键即可创建内联单元。</li>
                    </ul>
                    <aside>
                        <h4>附：快捷辅助键设计原则</h4>
                        <p>普通模式下大量的操作都可以使用热键（快捷键）完成，这可以极大地提高效率。为便于记忆，热键设定遵循如下原则。</p>
                        <ul>
                            <li><kbd>X</kbd>: 某单个键位，完成某个功能操作。如<kbd>C</kbd>键复制当前选取集并原地插入（<code>after</code>）。</li>
                            <li><kbd>Shift</kbd>+<kbd>X</kbd>: 当前功能增强。如<kbd>Shift+C</kbd>键复制当前选取集，各别插入原元素之后（<code>after</code>）。</li>
                            <li><kbd>Ctrl</kbd>+<kbd>X</kbd>: 当前功能相关的衍生功能。如<em>修订模式</em>下的<kbd>Ctrl+Enter</kbd>创建一个同类新行。</li>
                            <li><kbd>Alt</kbd>+<kbd>X</kbd>: 提供当前功能的额外能力，关联性更远一些。如<kbd>Alt+←</kbd>提升当前章节层级。</li>
                        </ul>
                        <p>当然，用户也可以根据自己的喜好修改系统默认的热键配置（详见：<em>base/shortcuts.js</em>）。</p>
                    </aside>
                </header>
                <section role="s2">
                    <h2>焦点元素</h2>
                    <header>
                        <p>选取集是元素按选中的先后顺序加入集合的，通常最后添加的元素拥有焦点。焦点是为了方便元素选取而设计的一个热点，大部分选取操作就是针对焦点元素而来。拥有焦点的元素即是焦点元素。</p>
                        <p role="tips"><strong>提示</strong>：内容区底部的路径栏显示的即是<em>焦点元素</em>的DOM路径信息。</p>
                        <p>焦点可以在任意元素间移动，通过鼠标单击点选，或者键入方向键来实现。这里的焦点与浏览器DOM元素焦点并不是同一个东西，为了与之相区别，我们可以视之为一种<strong>选取焦点</strong>。但下面为简单起见，统一称之为<strong>焦点</strong>。</p>
                    </header>
                    <section role="s3">
                        <h2>焦点移动</h2>
                        <p>选取焦点可通过键盘上的几个方向键移动，移动分为两个维度：</p>
                        <ul>
                            <li><strong>兄弟/平级</strong>：在DOM树的同级元素方向上，即兄弟元素间移动。</li>
                            <li><strong>父子/纵向</strong>：在DOM树的纵深方向上，即父子元素间的跨层级移动。</li>
                        </ul>
                        <p>借鉴Vim中的便捷方向键<code style="font-weight: bold; color: rgb(204, 0, 102);">hjkl</code>（左下上右），以及DOM节点树的逻辑，方向键含义如下：</p>
                        <ul>
                            <li><kbd>↑/K</kbd>： <strong>平级移动</strong>，定位到前一个（<code>prev</code>）兄弟元素。支持数字指定移动距离，默认值 <code>1</code>（即前一个兄弟元素），特殊值 <code>0</code> 表示头部首个兄弟元素。</li>
                            <li><kbd>↓/J</kbd>： <strong>平级移动</strong>，定位到下一个（<code>next</code>）兄弟元素。支持数字指定移动距离，默认值 <code>1</code>（即下一个兄弟元素），特殊值 <code>0</code> 表示末尾最后一个兄弟元素。</li>
                            <li><kbd>←/H</kbd>：<strong>纵向移动</strong>，定位到父元素（<em>父级方向</em>）。支持数字指定移动层级，默认值 <code>1</code>（即父元素）。</li>
                            <li><kbd>→/L</kbd>：<strong>纵向移动</strong>，定位到子元素（<em>子级方向</em>），支持数字指定子元素位置下标，默认值 <code>0</code>（即首个子元素），负值表示从末尾算起（<code>-1</code>&nbsp;为最后一个子元素）。</li>
                        </ul>
                        <p role="tips"><strong>提示</strong>：<br />在内容区拥有浏览器焦点时，键入数字可设置之后操作的前置计数。左下角状态栏有数字提示，按<kbd>ESC</kbd>取消计数。</p>
                        <p><kbd>Tab</kbd>：普通模式下，在当前选取集成员间按<em>选取顺序</em>移动焦点。加按<kbd>Shift</kbd>则逆向移动。</p>
                    </section>
                    <section role="s3">
                        <h2>附：顶元素</h2>
                        <p>顶元素是一个<strong>虚拟</strong>的根元素，方便用户快速定位到经常操作的目标。热键<kbd>T</kbd>可以将焦点移动到当前焦点元素的<strong>顶元素</strong>上。</p>
                        <ul>
                            <li>对于内联单元来说，顶元素是其所在行块的<strong>内容行</strong>元素。如<code>&lt;p&gt;</code>、<code>&lt;li&gt;</code>、<code>&lt;dd&gt;</code>和<code>&lt;td&gt;</code>等。</li>
                            <li>对于行块单元内的中间结构元素来说，其顶元素为单元自身的<strong>根元素</strong>。如<code>&lt;tr&gt;</code>的顶元素为<code>&lt;table&gt;</code>，<code>&lt;li&gt;</code>的顶元素为其所在的<code>&lt;ol&gt;</code>或<code>&lt;ul&gt;</code>等。</li>
                            <li>对于内联单元内的结构元素来说，其顶元素即是该内联<strong>单元本身</strong>。如<code>&lt;rt&gt;</code>的顶元素为<code>&lt;ruby&gt;</code>，SVG系子元素的顶元素为其所属根容器<code>&lt;svg&gt;</code>。</li>
                        </ul>
                    </section>
                </section>
                <section role="s2">
                    <h2>元素选取</h2>
                    <section role="s3">
                        <h2>鼠标点选</h2>
                        <p>通过鼠标<strong>单击</strong>的方式可以定位焦点元素并实现选取或取消选取。</p>
                        <ul>
                            <li><strong>单选</strong>：<code>单击</code>。鼠标单击目标元素即选中目标，但之前的选取会被取消。</li>
                            <li><strong>多选</strong>：<kbd>Ctrl</kbd> + <code>单击</code>。目标元素会被添加到当前选取集内。如果目标已经是被选取的，则会取消选取（<strong>切换</strong>）。</li>
                            <li><strong>聚焦</strong>：<kbd>Alt</kbd> + <code>单击</code>。仅将选取焦点移动到目标元素上，没有选取作用。这在某些需要定位的操作中很有用。</li>
                        </ul>
                        <p>下面的鼠标选取有一定的智能性，与焦点元素有关。</p>
                        <ul>
                            <li><strong>跨选</strong>：<kbd>Shift</kbd> + <code>单击</code>。将焦点元素到目标元素的同级兄弟元素全部<strong>选取</strong>或<strong>取消选取</strong>。如果目标元素层级较深，自动取与焦点元素同级的容器元素为目标。焦点同时移动到目标上。与起始的焦点元素保持<em>相同状态</em>（选取与否）可被称为<strong>同态</strong>。</li>
                            <li><strong>浮选</strong>：<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <code>单击</code>。以焦点元素所在层级为依据，对目标元素的同层级容器元素执行<strong>切换</strong>选取。如果目标不在焦点元素所属父容器内则无效（简单忽略）。</li>
                        </ul>
                        <p>下面的鼠标选取与焦点元素无关。</p>
                        <ul>
                            <li><strong>父选</strong>：<kbd>Alt</kbd> + <kbd>Ctrl</kbd> + <code>单击</code>。选取鼠标单击的目标元素的父元素，将之添加到当前选取集。如果目标的父元素已经选取，则为取消选取（<em>多选</em>/<em>切换选取</em>逻辑）。这在选取表格行元素（<code>&lt;tr&gt;</code>）时很有用。</li>
                            <li><strong>父焦</strong>：<kbd>Shift</kbd> + <kbd>Alt</kbd> + <code>单击</code>。仅将选取焦点移动到单击目标的父元素上，不影响当前选取集。</li>
                        </ul>
                        <aside>
                            <h4>同态：</h4>
                            <p>焦点元素有选取和非选取两者状态，让目标元素与焦点元素状态相同，可简称为<strong>同态</strong>操作。</p>
                        </aside>
                    </section>
                    <section role="s3">
                        <h2>按键选取</h2>
                        <p>如果焦点元素已经存在（<em>鼠标点选</em>），通过简单的键盘按键，我们可以实现更多的选取操作。</p>
                        <ul>
                            <li><kbd>Space</kbd> 或&nbsp;<kbd>Enter</kbd>：<strong>选取切换</strong>。焦点元素选取或取消选取。不影响其它已选取元素，类似&nbsp;<kbd>Ctrl</kbd> + <code>单击</code> 的效果。</li>
                            <li><kbd>Shift</kbd> + <em>箭头键</em>：<strong>单选游走</strong>。移动焦点的同时改选到目标元素，其它选取被取消，类似鼠标<code>单击</code>的效果。</li>
                        </ul>
                        <p role="tips"><strong>提示</strong>：支持 <kbd>Shift</kbd> + <kbd>T</kbd> 单选游走到焦点元素的<strong>顶元素</strong>。顶元素含义见后。</p>
                    </section>
                    <section role="s3">
                        <h2>选取扩展</h2>
                        <p>在现有选取集的基础上，通过简单的键位操作可以将选取集进行<em>扩展</em>。扩展以当前<strong>焦点元素</strong>为参考，键位定义如下：</p>
                        <p>下面的<em>扩展</em>与焦点元素状态有关，会执行<em>同态</em>操作。</p>
                        <ul>
                            <li><kbd>A</kbd>：<code>All</code>，定位<strong>全部</strong>兄弟元素，使得它们与焦点元素的状态相同。焦点不变。</li>
                            <li><kbd>E</kbd>：<code>Element</code>，定位<strong>同类</strong>的兄弟元素（相同标签），使之与焦点元素状态相同。焦点不变。</li>
                            <li><kbd>Shift</kbd> + <kbd>E</kbd>：定位<strong>叔伯</strong>元素（父元素的兄弟元素）内的<em>相同标签</em>子元素，使之与焦点元素状态相同。焦点不变。这在选取同一父章节下的子章节的标题时很有用，或者选取表格中的列头（<code>&lt;th&gt;</code>）时有用。</li>
                            <li><kbd>Alt</kbd> + <kbd>Shift</kbd> + <kbd>E</kbd>：定位叔伯元素中<strong>标签相同</strong>且所在<strong>位置也相同</strong>的子元素，使之与焦点元素状态相同。焦点不变。这在选取<em>表格中的一列</em>时很有用。或者选取一个列表中<em>每一行的首个子元素</em>（如果标签相同）时有用。</li>
                        </ul>
                        <p role="tips"><strong>提示</strong>：<br />新添加的元素位于选取集内的后部，这样的顺序可能并不是你想要的。按<kbd>S</kbd>键可以按DOM节点流顺序排序选取集。</p>
                        <p>下面的热键在移动焦点的同时会执行<strong>同态</strong>操作。</p>
                        <ul>
                            <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>↑</kbd>：同级<strong>向前</strong>（<code>previous</code>）扩展，支持前置数字指定扩展距离。焦点会移动到最终的元素上。</li>
                            <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>↓</kbd>：同级<strong>向后</strong>（<code>next</code>）扩展，支持同上。</li>
                        </ul>
                        <p role="note"><strong>注记</strong>：<kbd>Shift</kbd>在这里表示选取增强，<kbd>Ctrl</kbd>则表示<em>多选/切换选取</em>的逻辑，与鼠标多选逻辑相同。</p>
                        <p>下面的热键在移动焦点的同时会执行<strong>选取</strong>操作。<em>注：纵深方向上没有同态逻辑，因为选取成员不能相互包含。</em></p>
                        <ul>
                            <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>←</kbd>：<strong>向上</strong>移动焦点到<em>父元素</em>上，同时选取父元素。支持<em>数字</em>指定距离。</li>
                            <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>→</kbd>：<strong>向下</strong>移动焦点到<em>子元素</em>上，同时选取子元素。支持<em>数字</em>指定目标子元素的下表（<code>0</code>为首个）。</li>
                            <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>T</kbd>：移动焦点到当前焦点元素的顶元素（<code>Top</code>）上并选取。</li>
                        </ul>
                        <p>下面的操作与焦点元素状态无关，为固定的<em>选取</em>和<em>取消选取</em>逻辑。</p>
                        <ul>
                            <li><kbd>V</kbd>：同级<strong>反选</strong>。针对焦点元素所在层级，已选取的元素<em>取消选取</em>，未选取的元素<em>选取</em>。焦点不变。</li>
                            <li><kbd>W</kbd>：<strong>宽选</strong>内容子。向下检索焦点元素内全部<strong>内容根</strong>元素，将之添加到选取集。焦点移动到首个成员（<em>以体现视觉变化</em>）。</li>
                            <li><kbd>Shift</kbd> + <kbd>W</kbd>：同上<strong>宽选</strong>逻辑，但新的内容子元素插入到选取集头部而非末尾。焦点移动到首个成员。</li>
                            <li><kbd>Q</kbd>：<strong>排他选取</strong>。取消焦点元素之外的同级已选取，保留焦点元素的选取（<em>若未选取则自动选取</em>）。</li>
                            <li><kbd>Shift</kbd> + <kbd>Q</kbd>：全局<strong>排他选取</strong>。取消焦点元素之外全部已选取，保留焦点元素的选取或自动选取。</li>
                            <li><kbd>ESC</kbd>：<strong>取消</strong>全部选取和焦点元素的选取焦点（<strong>注</strong>：可撤销）。</li>
                        </ul>
                    </section>
                    <section role="s3">
                        <h2>虚焦点支持</h2>
                        <p>大部分的选取操作都是基于<em>焦点元素</em>，但焦点元素只有一个。对于需要批量操作的场景，这并不友好，因此这里引入了<strong>虚焦点</strong>的设计。</p>
                        <p>虚焦点是把选取集内的<strong>每一个成员都视为焦点元素</strong>，然后执行特定的操作。支持虚焦点的操作并不多，并且只有<strong>选取</strong>而没有<em>同态</em>的逻辑。因为每一个成员都变成了焦点，所以这里有一些限制：</p>
                        <ol>
                            <li>仅适用部分简单的选取，比如<kbd>E</kbd>选取同级同类元素，复杂的叔伯元素选取（<kbd>Shift+E</kbd>）则不适用。</li>
                            <li>平级操作时（如<kbd>E</kbd>）选取集内的成员不能互为兄弟元素，每个成员只能是其父元素内的唯一选取。纵向操作（<kbd>W</kbd>）则无此约束。</li>
                        </ol>
                        <p>通常，支持虚焦点的操作会辅以<kbd>Alt</kbd>键。可用操作共<strong>8</strong>个：</p>
                        <ul>
                            <li><strong>平级类</strong>：<kbd>A</kbd>、<kbd>E</kbd>、<kbd>Ctrl+Shift+↑</kbd>、<kbd>Ctrl+Shift+↓</kbd>，其中的 <kbd>Ctrl</kbd> 改为 <kbd>Alt</kbd>。每个成员在其父元素内为单选，因为操作之后即失去了唯一性，所以这是<em>一次性</em>的。</li>
                            <li><strong>纵深类</strong>：<kbd>W</kbd>、<kbd>Ctrl+Shift+→</kbd>、<kbd>Ctrl+Shift+←</kbd>、<kbd>Ctrl+Shift+T</kbd>，其中的 <kbd>Ctrl</kbd>改为 <kbd>Alt</kbd>。向下选取时元素各自独立，向上改选时共同的父级元素会被自动去重。</li>
                        </ul>
                        <p>如果操作使用了虚焦点，<em>平级类</em>会保留原来的实际焦点不变，但<em>纵深类</em>则会将焦点移到整个选取集的<strong>首个</strong>成员上。</p>
                    </section>
                    <section role="s3">
                        <h2>路径辅助选取</h2>
                        <p>在编辑器内容区的底部会显示当前焦点元素的<strong>DOM树路径</strong>，用鼠标单击其中任何一段，即可<strong>选取</strong>相应的元素。路径提供了清晰的节点树层次，可用于精确选取。</p>
                        <p>从路径上添加选取也可以是切换方式，按住<kbd>Ctrl</kbd>键单击即为切换，无辅助键则为简单多选。如果只需要从路径上<strong>聚焦</strong>目标元素，可按住<kbd>Alt</kbd>单击。注意此时只是改变焦点，路径序列并不会重构。</p>
                        <p role="tips"><strong>提示</strong>：将鼠标滑过路径上的不同部分，会有其对应元素的背景阴影提示。</p>
                    </section>
                    <section role="s3">
                        <h2>选取集排序</h2>
                        <p>元素的选取方式非常多也很灵活，但选取集内部成员的顺序有时是很重要的，比如<em>合并</em>、<em>移动插入</em>或者系统级的<em>复制</em>/<em>粘贴</em>等。除了通过仔细的按顺序选取外，如果要让选取集成员按DOM节点流排序，可以用如下热键完成。</p>
                        <ul>
                            <li><strong>正序</strong>：<kbd>S</kbd>。选取集按DOM节点流排序，焦点定位到排序后的首个成员。</li>
                            <li><strong>逆序</strong>：<kbd>Shift+S</kbd>。选取集按DOM节点树逆序排序，焦点定位规则同上（DOM上看为<em>最后一个</em>元素）。</li>
                        </ul>
                    </section>
                </section>
                <section role="s2">
                    <h2>编辑操作</h2>
                    <header>
                        <p>与选取类操作以焦点元素为中心不同，编辑操作的目标就是整个选取集成员。但<em>焦点元素</em>在这里有另外的用途——<em>定位</em>操作关联的目标。借鉴于<strong>Vim</strong>的操作便捷性，这里大部分的操作也都采用单个键位（或加辅助键）完成。</p>
                    </header>
                    <section role="s3">
                        <h2>普通编辑</h2>
                        <ul>
                            <li><strong>删除</strong>：<kbd>Delete</kbd>。删除选取集内的元素，有一定智能性，部分不可单独删除的不会删除（如：<code>&lt;td&gt;</code>、<code>&lt;rb&gt;</code>等）。</li>
                            <li><strong>内容删除</strong>：<kbd>Shift+Delete</kbd>。删除选取集元素内的可编辑内容（即内容元素里的内容），不含元素自身。</li>
                            <li><strong>强制删除</strong>：<kbd>Alt+Shift+Delete</kbd>。删除选取集内的任意元素，包括结构中不应被删除的子元素。有一定破坏性。</li>
                        </ul>
                        <ul>
                            <li><strong>撤消</strong>：<kbd>U</kbd>。Undo，撤销当前操作的选取或编辑。</li>
                            <li><strong>重做</strong>：<kbd>R</kbd>。Redo，重做被撤销的操作。</li>
                            <li><strong>逆序</strong>：<kbd>X</kbd>。将选取集内的同级兄弟元素逆序重排（移动），未选取的同级元素会保持原位置。</li>
                            <li><strong>合并</strong>：<kbd>Z</kbd>。将选取集内的元素的内容按选取顺序合并为一，<strong>首个</strong>选取的元素为容器，仅适用于内容元素。</li>
                            <li><strong>规范合并</strong>：<kbd>Alt+Z</kbd>。对整个内容区规范化（<code>normalize</code>合并相邻的文本节点）。通常不需要。这是一种DOM优化，在执行搜索命令时有用，因为搜索会以文本节点为边界，相邻的文字如果属于不同节点，则不能成词。</li>
                        </ul>
                        <ul>
                            <li><strong>分组克隆</strong>：<kbd>C</kbd>。以选取集内<strong>相邻的元素</strong>为分组，整体克隆并插入原组之后（<code>after</code>）。选取集更新为新插入的元素。<strong>特例</strong>：如果选取集只有一个成员，支持数字指定克隆数量。</li>
                            <li><strong>各别克隆</strong>：<kbd>Shift+C</kbd>。对选取集内的每一个成员独自克隆并插入其后（<code>after</code>）。选取集更新为新插入的元素。</li>
                        </ul>
                        <ul>
                            <li><strong>转为大写</strong>：<kbd>Ctrl+U</kbd>。将选取集元素的文本全部转换为大写，如果加按<kbd>Alt</kbd>键，仅首段文本内的首个匹配转换。</li>
                            <li><strong>转为小写</strong>：<kbd>Ctrl+L</kbd>。将选取集元素的文本全部转换为小写。</li>
                        </ul>
                        <p style>以下操作与<em style>焦点元素</em>有关。</p>
                        <ul>
                            <li><strong>向内填充</strong>：<kbd>F</kbd>。将选取集成员<strong>移动</strong>填充到焦点元素之内（<code>fill</code>）。焦点元素<strong>不应当</strong>被选取。若源为非法子元素（结构限制），会自动提取其内容创建目标位置的默认子元素。</li>
                            <li><strong>克隆填充</strong>：<kbd>Shift+F</kbd>。将选取集成员<strong>克隆</strong>填充到焦点元素之内（<code>fill</code>）。焦点元素可以作为数据源。非法子元素规转换则同上。</li>
                            <li><strong>向内添加</strong>：<kbd>D</kbd>。将选取集成员<strong>移动</strong>添加到焦点元素内末尾（<code>append</code>）。焦点元素<strong>不应当</strong>被选取。非法子元素转换规则同上。</li>
                            <li><strong>克隆添加</strong>：<kbd>Shift+D</kbd>。将选取集成员<strong>克隆</strong>添加到焦点元素内末尾（<code>append</code>）。焦点元素可以作为数据源。非法子元素转换规则同上。</li>
                        </ul>
                        <ul>
                            <li><strong>移动前插入</strong>：<kbd>I</kbd>。将选取集成员<strong>移动</strong>并插入到焦点元素之前（<code>before</code>）。不可被删除的元素会移除其<strong>内容</strong>，焦点元素不可选取，非法元素转换规则同前。</li>
                            <li><strong>克隆前插入</strong>：<kbd>Shift+I</kbd>。将选取集成员<strong>克隆</strong>并插入到焦点元素之前（<code>before</code>）。焦点元素可以作为数据源，非法元素转换规则同前。</li>
                            <li><strong>移动后插入</strong>：<kbd>B</kbd>。将选取集成员<strong>移动</strong>并插入到焦点元素之后（<code>after</code>）。不可删除规则同上，焦点元素不可选取，非法元素转换规则同前。</li>
                            <li><strong>克隆后插入</strong>：<kbd>Shift+B</kbd>。将选取集成员<strong>克隆</strong>并插入到焦点元素之后（<code>after</code>）。焦点元素可以作为数据源，非法元素转换规则同前。</li>
                        </ul>
                        <aside>
                            <h4>注意：</h4>
                            <p>插入的顺序是按照选取的顺序逐个提取。这样的设计可以提高灵活性，如果需要有序，可以按<kbd>S</kbd>键排序。</p>
                            <p>上面的移动是<strong>跨层级</strong>的，适用任意目标位置。如果位置非法，内容会被<em>自动转换</em>。但这种移动并不那么直观，需要<em>焦点元素</em>来定位。下面有专注于简单移动的操作，比如兄弟元素之间的<em>平级移动</em>。</p>
                        </aside>
                    </section>
                    <section role="s3">
                        <h2>移动与缩进</h2>
                        <p>移动与缩进是编辑中常见的操作，这里的移动是元素自身的移动，但受限于内容单元固有的<em><code>HTML</code>结构</em>，这里的移动仅限于兄弟元素之间的<strong>平级</strong>移动。</p>
                        <p><strong>缩进</strong>的操作只适用于章节，针对<em>章节</em>（<code>s1-s5</code>）或<em>片区</em>（<code>section</code>）单元。包含<strong>升级</strong>和<strong>降级</strong>两种操作。</p>
                        <ul>
                            <li><strong>向前移动：</strong><kbd>Alt+↑</kbd>。选取集成员在各自父元素内平级移动，支持数字指定距离，超出范围会导致部分或全部逆序插入。<code>0</code> 值表示端部，有汇聚插入的效果。</li>
                            <li><strong>向后移动：</strong><kbd>Alt+↓</kbd>。数字支持同上，移动行为类似（方向不同）。</li>
                            <li><strong>章节升级</strong>：<kbd>Alt+←</kbd>。章节或片区左缩进，升级之后会排列到当前父片区之后（<code>after</code>）。<strong>注</strong>：这种层级递升不一定必然表现出视觉差异。</li>
                            <li><strong>章节降级</strong>：<kbd>Alt+→</kbd>。章节或片区右缩进，会在原地创建一个空的片区容器来包含被降级的片区。</li>
                        </ul>
                        <aside>
                            <h4>注：</h4>
                            <p>同级兄弟元素间可自由移动，但不能跨越固定性单元，如标题（<code>&lt;h4&gt;</code>）元素。</p>
                            <p>顶层章节的升级会被简单忽略，末层章节（<code>&lt;section role="s5"&gt;</code>）再降级会变成没有 <code>role</code> 定义的普通<strong>深片区。</strong></p>
                        </aside>
                    </section>
                    <section role="s3">
                        <h2>进入微编辑</h2>
                        <p>可以对元素内容进行简单的修订（<code>Modify</code>），这通过进入一种<strong>微编辑</strong>的状态实现。这种修订仅适用于<em>内容元素</em>。有多个选取元素时，微编辑可按选取元素的顺序逐个进入。</p>
                        <p>编辑完成后按<kbd>Enter</kbd>或<kbd>Tab</kbd>键确认并退出。如果是<kbd>Tab</kbd>且选取集内还有元素，则切换到下一个成员。</p>
                        <ul>
                            <li><kbd>M</kbd>：进入微编辑，光标定位到单击点。如果单击点不在元素内，进入后为全选状态。</li>
                            <li><kbd>Shift+M</kbd>：进入微编辑，光标定位到元素内容的末端。</li>
                            <li><kbd>Enter</kbd>：确认当前修订（退出微编辑）。</li>
                            <li><kbd>Tab</kbd>：确认当前修订。如果有多个选取，按选取顺序进入到下一个元素的修订。</li>
                        </ul>
                        <p role="tips"><strong>提示</strong>：非内容元素不能直接进入微编辑，此时可以按<kbd>W</kbd>或<kbd>Shift+W</kbd>选取其内容元素然后再继续。</p>
                    </section>
                    <section role="s3">
                        <h2>定位移动</h2>
                        <p>有时侯需要内容处于准确的平面位置，通常是设置其绝对样式（<code>position:absolute</code>以及<code>left</code>或<code>top</code>值）。这种定位方法需要用户了解一些CSS知识，如对容器设置<code>position:relative</code>样式。</p>
                        <p>如果容器已经设置了<code>position:relative</code>，元素自身设置了<code>position:absolute</code>，通过下面的操作就可以简单调整位置。</p>
                        <ul>
                            <li><kbd>Ctrl+←</kbd>：向左移动<strong>1</strong>像素。加按<kbd>Shift</kbd>则以<strong>10</strong>像素为单位。</li>
                            <li><kbd>Ctrl+→</kbd>：向右移动<strong>1</strong>像素。加按<kbd>Shift</kbd>键同上。</li>
                            <li><kbd>Ctrl+↑</kbd>：向上移动<strong>1</strong>像素。加按<kbd>Shift</kbd>键同上。</li>
                            <li><kbd>Ctrl+↓</kbd>：向下移动<strong>1</strong>像素。加按<kbd>Shift</kbd>键同上。</li>
                        </ul>
                        <aside>
                            <h4>注意：</h4>
                            <p>对于没有设置绝对定位的元素，这些组合键操作会被简单忽略。<em>插图</em>单元在内容样式文件中通常有其<em>图片讲解</em>的<code>position: absolute</code>和容器的<code>position：relative</code>定义，因此无需手动设置。</p>
                        </aside>
                    </section>
                    <section role="s3">
                        <h2>复制和粘贴事件</h2>
                        <p>普通模式下支持系统级（浏览器）的<strong>复制</strong>、<strong>剪切</strong>和<strong>粘贴</strong>操作，操作目标为当前<strong>选取集</strong>元素。</p>
                        <ul>
                            <li><strong>复制</strong>：提取选取集元素的文本内容（<code>textContent</code>）到剪贴板，若有多个选取，内容以换行符分隔。</li>
                            <li><strong>剪切</strong>：规则同复制，但同时会删除元素本身，如果元素可以被删除的话。</li>
                            <li><strong>粘贴</strong>：以换行符切分剪贴板里的<strong>文本</strong>内容，分别添加到选取集元素或其<em>根内容元素</em>内。如果选取集只有一个成员，内容不会切分。粘贴默认为<em>填充覆盖</em>方式，加按<kbd>Shift</kbd>键为<em>末尾追加</em>（<code>append</code>）方式。</li>
                        </ul>
                        <aside>
                            <h4>注意：</h4>
                            <p>粘贴里的插入<strong>分组</strong>仅与<strong>选取</strong>有关，比如选取了一个<code>&lt;tr&gt;</code>元素，因为它不是内容元素，所以会宽选其内部的单元格为目标，但此时并不会分组，相同的内容会插入到其内所有单元格中。如果需要与单元格一一对应，应当选取单元格本身。</p>
                            <p>提取或插入的分组是按<em>选取顺序</em>对应的，可能你需要先按<kbd>S</kbd>键来排哈序。</p>
                        </aside>
                    </section>
                </section>
                <section role="s2">
                    <h2>杂项功能</h2>
                    <ul>
                        <li><kbd>P</kbd>：打开目标单元的<strong>属性</strong>编辑框。<em><strong>注</strong>：从右击鼠标弹出的上下文菜单中也可以。</em></li>
                        <li><kbd>Alt+P</kbd>：<strong>导出</strong>选取单元或全文内容<em>源码</em>，会自动打开导出对话框。</li>
                        <li><kbd>Alt+Shift+P</kbd>：<strong>导出</strong>全文内容<em>源码</em>，同时会在适当的位置插入文章<strong>目录</strong>（大纲）。与选取元素无关。</li>
                        <li><kbd>Ctrl+S</kbd>：内容源码<strong>本地暂存</strong>（<code>localStorage</code>）。<em><strong>注</strong>：刷新页面会自动导入之前保存的内容。</em></li>
                        <li><kbd>G</kbd>：<strong>章节跳转</strong>。根据键入的章节序列（如：<code>3.12.5</code>），将目标章节滚动到当前视口。<em><strong>注</strong>：需内容区聚焦。</em></li>
                    </ul>
                </section>
                <section role="s2">
                    <h2>格式刷</h2>
                    <p>样式标签栏有一个<strong>格式刷</strong>按钮，可以对选取集内的元素应用<strong>焦点元素</strong>的样式。这种操作并不像普通编辑器（如Word）里那样，用刷子去同步样式，而是反过来先选取元素，再定位同步的样式源（选取焦点）。</p>
                    <p>虽然<strong>内联的样式</strong>很方便设置，但文档编写者应当<strong>注意</strong>，这些内联的样式是一种<strong>硬编码</strong>，并不方便应用<em>外部共享</em>的样式。</p>
                    <p role="tips"><strong>提示</strong>：这里编辑的文档有着规范化的HTML结构，样式共享很容易。你的读者可能希望使用他喜欢的样式来阅读。</p>
                </section>
            </section>
            <section role="s1">
                <h2>录入面板</h2>
                <header>
                    <p>与普通编辑器的原地输入不同，本设计的内容录入主要通过内容面板来实现。</p>
                    <p>因为文章的内容单元有<em>结构性</em>限制，内容只能出现在<em>合法的位置</em>（比如<code>&lt;caption&gt;</code>只能在表格内），所以录入面板的创建方式更合理，这样可以很方便地限定在什么位置创建什么内容。</p>
                    <p>目标位置用<strong>选取集</strong>元素来标识，新的内容可以插入到该位置<em>之前</em>、<em>之后</em>或<em>内部</em>。如果选取了多个元素，可插入项目是各个目标可插入项目的交集，而内容也会同时插入到各个目标位置处。</p>
                </header>
                <section role="s2">
                    <h2>快捷键</h2>
                    <section role="s3">
                        <h2>文本框&lt;textarea&gt;</h2>
                        <ul>
                            <li><kbd>Alt+F</kbd>：录入框最大化<strong>切换</strong>（相对于面板）。<em><strong>注</strong>：也可以按<kbd>ESC</kbd>键取消最大化。</em></li>
                            <li><kbd>Ctrl+Enter</kbd>：直接<strong>提交</strong>插入，效果同单击<code>插入</code>按钮。焦点会保持在录入框内。</li>
                            <li><kbd>Alt+Ctrl+Enter</kbd>：同上直接<strong>提交</strong>。但如果录入框已最大化，会恢复到普通状态。</li>
                        </ul>
                    </section>
                    <section role="s3">
                        <h2>表格单元&lt;th|td&gt;</h2>
                        <ul>
                            <li><kbd>Enter</kbd>：切换到当前列的<strong>下一个</strong>单元格。</li>
                            <li><kbd>Shift+↓</kbd>：同上当前列<em>向下</em>切换。</li>
                            <li><kbd>Shift+↑</kbd>：切换到当前列的<strong>上一个</strong>单元格。</li>
                            <li><kbd>Shift+Enter</kbd>：插入<strong>换行符</strong>（浏览器自身功能保留）。</li>
                        </ul>
                        <ul>
                            <li><kbd>Ctrl+V</kbd>：浏览器<em>粘贴</em>功能，但内容以换行符分段，从当前单元格开始向后<em>连续覆盖</em>。</li>
                            <li><kbd>Shift+Ctrl+V</kbd>&nbsp;保留浏览器普通方式粘贴（纯文本）。</li>
                        </ul>
                        <p role="tips"><strong>提示</strong>：智能切分粘贴只支持<em>当前行</em>单元格。如果需要一次性对<em>多行粘贴</em>，可在内容区的普通模式下进行。</p>
                    </section>
                    <section role="s3">
                        <h2>代码框&lt;pre._code&gt;</h2>
                        <p>录入代码的文本框支持一些简单的<strong>友好编辑</strong>行为：比如回车<em>自动缩进</em>，初始粘贴自动<em>去除多余缩进</em>，<kbd>Tab</kbd>键自动插入多个空格（一个缩进），而退格键<kbd>Backspace</kbd>则自动删除一个缩进等。</p>
                        <p>因为代码框拦截了<kbd>Enter</kbd>键的行为，所以前面普通文本框里的<em>快捷提交</em>功能就没有了。你需要明确点按<code>插入</code>按钮来完成提交。</p>
                    </section>
                </section>
            </section>
            <section role="s1">
                <h2>修订模式</h2>
                <header>
                    <p>内容元素的<code>contenteditable</code>特性被设置为<code>true</code>时即进入了修订模式。因为浏览器处理<code>contenteditable</code>元素的差异较大，所以这里进行了严格约束，编辑范围也被严格限制。这种模式应当仅用于简单的文本修改和新行创建。</p>
                    <p>约束主要体现在对<kbd>Enter</kbd>键的限制上：</p>
                    <ul>
                        <li><kbd>Enter</kbd>：确认当前修订并退出。</li>
                        <li><kbd>Shift+Enter</kbd>：插入一个换行<code>&lt;br&gt;</code>元素，在<code>&lt;pre&gt;</code>元素内会插入一个换行字符<code>\n</code>。<em><strong>注</strong>：浏览器自身功能。</em></li>
                        <li><kbd>Ctrl+Enter</kbd>：新建一个<em>同类</em>空行，原行自动确认。适用于段落类和列表项元素<code>&lt;li&gt;</code>, <code>&lt;dt&gt;,</code><code>&lt;dd&gt;</code>。</li>
                        <li><kbd>Alt+Enter</kbd>：新建一个<em>逻辑</em>空行，原行自动确认。适用诸如<code>&lt;dt&gt;</code>之后的<code>&lt;dd&gt;</code>，或者<code>&lt;summary&gt;</code>之后的<code>&lt;p&gt;</code>等。</li>
                        <li><kbd>Tab</kbd>：完成当前修订并切换到下一个选取的元素。如果没有其它已选取的元素，则同<kbd>Enter</kbd>。</li>
                        <li><kbd>ESC</kbd>：取消当前修订并退出微编辑。</li>
                    </ul>
                    <aside>
                        <h4>换行兼容性：</h4>
                        <p><kbd>Enter</kbd>的行为在不同浏览器之间差异较大，<kbd>Shift+Enter</kbd>则较为一致。</p>
                        <p><code>&lt;pre&gt;</code>元素在微编辑修订后，其中的换行元素<code>&lt;br&gt;</code>会被强制替换为换行字符<code>\n</code>，以保证内容的一致性。</p>
                    </aside>
                    <p>对于<strong>代码元素</strong><code>&lt;code&gt;</code>，如果元素上有语言定义（<code>data-lang</code>），完成后自动解析语法高亮。</p>
                </header>
            </section>
            <section role="s1">
                <h2>属性框</h2>
                <p>如果选中的元素有属性可修改，键入热键<kbd>P</kbd>可以打开属性编辑框。也可以从上下文菜单中点选属性条目打开。如果选中多个同类元素，打开的属性修改将应用到多个目标上。</p>
                <p>操作单个目标时，修改的属性会逐一应用：文本框内的<em>空串</em>会使该属性被<em>移除</em>。</p>
                <p>操作多个目标时，如果各个目标的某属性的值不一样，则出现<strong>不确定</strong>（<code>indeterminate</code>）态。如果不确定态的条目未作改变，则对应属性则保持原样。<em>不确定</em>态的控件表现约定如下：</p>
                <ul>
                    <li><strong>文本框</strong>：包含<code>&lt;input:text&gt;</code>和<code>&lt;textarea&gt;</code>两种，无值时表示不确定态。</li>
                    <li><strong>单选按钮</strong>：同一组单选按钮没有任一按钮被选中时，表示不确定态。</li>
                    <li><strong>复选按钮</strong>：浏览器支持其<em>不确定</em>态的特殊外观（可能是小方框内一个短横线）。</li>
                    <li><strong>条目选单</strong>：即<code>&lt;select&gt;</code>元素，类似单选按钮组，没有任一条目被选中时为不确定态。</li>
                </ul>
                <p role="tips"><strong>提示</strong>：如果选取的多个目标类型不同，热键<kbd>P</kbd>不会有反应，展开上下文菜单时会发现<em>属性</em>条目为<em>禁用</em>状态。</p>
            </section>
            <section role="s1">
                <h2>命令行</h2>
                <header>
                    <p>编辑器底部状态栏上的文本输入条即是<strong>命令行</strong>，在这里可以执行一些高级操作。命令行支持简单的<em>历史搜索</em>：键入<kbd>Tab</kbd>键会显示上一次执行的命令，<em>在此基础上</em>键入<strong>上下箭头</strong>键可以在历史栈中游历。</p>
                    <p>命令行支持<strong>5</strong>种指令类型，分别由5个特殊字符标识：</p>
                    <ul>
                        <li><kbd>&gt;</kbd>： <strong>选取</strong>。命令行内容为<code>CSS</code>选择器，可在当前选取集或全局范围（内容区）内检索选取目标元素。</li>
                        <li><kbd>|</kbd>： <strong>过滤</strong>。命令行内容为过滤条件，可对当前选取集执行过滤。</li>
                        <li><kbd>/</kbd>： <strong>搜索</strong>。命令行内容为搜索的<em>目标文本</em>，在选取集或全局搜索范围搜索目标文本并<em>标记</em>。</li>
                        <li><kbd>:</kbd>： <strong>命令</strong>。命令行内容为编辑器支持的<em>命令</em>，主要是一些基本的工具函数。</li>
                        <li><kbd>=</kbd>： <strong>计算</strong>。将命令行内容视为<code>JS</code>表达式，执行简单的计算并返回到命令行<em>回显</em>。</li>
                    </ul>
                    <p>命令行有全局的热键可以直达：键入代表指令类型的<strong>特殊字符</strong>即可，这会自动<em>切换</em>命令行指令类型，并将输入焦点定位到命令行中。当然用鼠标单击命令行前的<em>特殊字符框</em>也可以实现切换。</p>
                </header>
                <section role="s2">
                    <h2>选取（<kbd>&gt;</kbd>）</h2>
                    <p>在当前选取集范围内检索目标选择器匹配的元素。支持二阶检索选择器：斜线分隔向上和向下选择器，焦点元素为起点。如果没有已选取的元素，则在全局范围（内容区）内检索。</p>
                    <aside>
                        <h4>二阶检索</h4>
                        <p>这是一种<em>最近路径</em>检索法：首先向上查找与目标元素最近的<strong>共同祖先</strong>容器，然后向下检索目标元素。这可以压缩范围以提高效率，同时还可以回避标识名全局唯一性的约束（小范围内唯一即可）。</p>
                        <p>二阶检索需要存在<strong>起点元素</strong>，即从一个起点元素查找另一个元素，类似于相对路径的逻辑。通常应用在一个元素的事件处理器中（以当前元素为起点）。</p>
                        <p>二阶检索通过<em>二阶选择器</em>来实现，格式：<code style="font-weight: bold;">Up-selector/Down-selector</code></p>
                        <ol>
                            <li><code>Up-selector</code>：从起点元素向上检索共同祖先的<code>CSS</code>选择器。也可以是数字，表示上升的DOM层级。</li>
                            <li><code>Down-selector</code>：当向上抵达共同祖先节点后，向下检索目标的<code>CSS</code>选择器。</li>
                        </ol>
                        <p style="font-weight: bold;">示例：</p>
                        <ul>
                            <li><code style="font-weight: bold;">/</code>：单独的斜线分隔符表示起点元素自身。同：<code>0/</code>。</li>
                            <li><code style="font-weight: bold;">2/</code>：祖父元素自身（父元素的父元素）。</li>
                            <li><code style="font-weight: bold;">form/input</code>：当前表单内的首个&lt;input&gt;元素。</li>
                            <li><code style="font-weight: bold;">.abc</code>：整个文档（<code>document</code>）内类名为<code>abc</code>的元素。没有斜线分隔视为普通的<code>CSS</code>选择器。</li>
                            <li><code style="font-weight: bold;">/#xyz</code>：起点元素内id为<code>xyz</code>的元素。即便其它地方存在同名的id，也会正常检索到目标。</li>
                        </ul>
                    </aside>
                </section>
                <section role="s2">
                    <h2>过滤（<kbd>|</kbd>）</h2>
                    <p>以当前选取集为总集，过滤出目标元素集。支持<em>选择器</em>、<em>数组定位</em>以及<em>过滤函数</em>的筛选形式。</p>
                    <ul>
                        <li><code>String</code>：普通CSS选择器。</li>
                        <li><code>[n:m]</code>：冒号分隔的数组下标范围（空格可选），如：<code>[5:10]</code>、<code>[5:]</code>等。</li>
                        <li><code>[x,y,z]</code>：数组下标定位选取，如：<code>[0,3,4]</code>。</li>
                        <li><code>{function}</code>：花括号包围的过滤函数。通常应当使用箭头函数。</li>
                    </ul>
                </section>
                <section role="s2">
                    <h2>搜索（<kbd>/</kbd>）</h2>
                    <p>对已选取的集合执行文本搜索，并把结果标记为特殊的<code>&lt;mark&gt;</code>元素。如果当前无选取，则以内容区为范围。</p>
                    <p>文本搜索以<em>文本节点</em>为上下文，因此跨节点的文本无法组词。如果必要，你可以执行一次节点合并操作（<kbd>Alt+Z</kbd>），以避免无意中断开了连续的文本。这种简化有它的合理性：既然文本被断开了，它们就不应当成为一个<em>词组</em>。</p>
                    <p>搜索词默认为字符串，容错引号包围。同时也支持正则表达。</p>
                    <ul>
                        <li><code>Hello</code>：普通文本，回车后执行检索。键入<code>'Hello'</code>也效果相同。</li>
                        <li><code>abc/xyz/ok</code>：普通文本，文本内的斜线只是普通字符。</li>
                        <li><code>"/[a-z]/i"</code>：字符串包围的普通文本。这也是搜索正则表达式本身的方式。</li>
                    </ul>
                    <ul>
                        <li><code>/[0-9a-f]/i</code>：正则表达式，由前置的<code>/</code>标示出来。</li>
                        <li><code>/[0-9a-f]+</code>：缺少结尾的<code>/</code>，视为一个普通的字符串。</li>
                        <li><code>/[\w.$-]+/</code>：合法的正则表达式。</li>
                        <li><code>/[0-9a-f]/ </code>：搜索词中的空格不会被自动清除，因此这不是一个合法的正则表达式。</li>
                    </ul>
                    <p role="tips"><strong>提示</strong>：<br />并不能在搜索表达式中直接使用替换，如果需要，可以在命令模式下执行<code>replace</code>指令来实现。</p>
                </section>
                <section role="s2">
                    <h2>命令（<kbd>:</kbd>）</h2>
                    <p>支持几个基本的工具命令：</p>
                    <ul>
                        <li><code>plug-ins</code>：插件安装。</li>
                        <li><code>plug-del</code>：插件移除。</li>
                        <li><code>help</code>：开启帮助窗口并定位到指定的关键字条目。</li>
                        <li><code>config</code>：显示&amp;设置系统配置。</li>
                        <li><code>replace</code>：替换选取集文本，仅适用内容元素。两个实参时用法参考<code>String.replace()</code>。</li>
                    </ul>
                </section>
                <section role="s2">
                    <h2>计算（<kbd>=</kbd>）</h2>
                    <p>用户的输入会直接在顶层（<strong>window</strong>）执行，用户需要注意代码的<em style="color: rgb(204, 0, 0);">安全性</em>，<em>不应当</em>在表达式中修改DOM树结构！</p>
                </section>
            </section>
            <section role="s1">
                <h2>其它</h2>
                <section role="s2">
                    <h2>表格的容错编辑</h2>
                    <p>通过特性编辑面板，用户可以修改表格单元格的<code>rowspan</code>和<code>colspan</code>特性，因此对于了解HTML的用户来说，他们可以自由构建不规整的表格结构。编辑器不阻止用户<em>删除</em>或<em>插入</em>独立的单元格。</p>
                    <p>这种能力是用户自己的，如果克隆表格行（<code>&lt;tr&gt;</code>），编辑器并不会检查单元格的这两个特性值。</p>
                </section>
                <section role="s2">
                    <h2>兼容性依赖</h2>
                    <p>修订模式下需要浏览器的<code>document.execCommand</code>支持，以实现从外部插入内容时，可以直接沿用浏览器自身的<strong>Undo</strong>和<strong>Redo</strong>功能。这简化了编码复杂性。</p>
                </section>
            </section>
        </article>
    </main>
</body>
</html>