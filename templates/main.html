<!-- 工具栏 -->
<div class="___Panel Tools" tpl-name="main:tools"
    on="click|$('#g-scroll') focus">
    <div class="_start _icons">
        <b id="x-outline" title="大纲" class="_press"
            on="toggle|$$('#outline,#lineLeft') lose(2) ('_press');
                click"
            to="|toggleClass;
                |trigger('toggle')|fire('body', 'pcheck')">
            <i id="b-outline"></i>
        </b>
        <b id="x-slave" title="主面板" class="_press"
            on="toggle|$('#main-slave') lose(2) ('_press');
                click"
            to="|toggleClass;
                |trigger('toggle')|fire('body', 'pcheck')">
            <i id="b-slave"></i>
        </b>
    </div>
    <hr>
    <div class="_middle _icons">
        <!-- 动态 -->
        <span id="tools-usual" class="_usual _icons" data-pbo="">
            <b title="文本化"
                on="click"
                by="Ed.toText"><i id="b-totext"></i></b>
            <b title="内容提升"
                on="click"
                by="Ed.unWrap"><i id="b-conup"></i></b>
            <hr>
        </span>
        <!--撤销：
            state  状态设置：true禁用，false启用。
            enable 仅用于直接开启。-->
        <b id="tools-undo" title="撤消" data-pbo="disabled"
            on="state|evo(1) ev('detail') disable(_1);
                click|evo(3) disabled end (Kit) call('undo');
                enable|evo(1) disable(0)"
            to="#tools-redo|trigger('enable')"><i id="b-undo"></i></b>
        <!-- 重做 -->
        <b id="tools-redo" title="重做" data-pbo="disabled"
            on="state|evo(1) ev('detail') disable(_1);
                click|evo(3) disabled end (Kit) call('redo');
                enable|evo(1) disable(0)"
            to="#tools-undo|trigger('enable')"><i id="b-redo"></i></b>
    </div>
    <div class="_end _icons">
        <b id="x-plugins" title="插件"
            on="click|tpl('modal:plugins')"
            to="#g-modal>*|replace trigger('open', true)">
            <i id="b-plugins"></i>
        </b>
        <b title="最大化"><i id="b-maximize"></i></b>
    </div>
</div>


<!-- 内容区 -->
<div class="___Content" tpl-name="main:content">
    <!--滚动封装（不在<main>上，避免聚焦影响）
        keydown 快捷键操作（key, count）
        keyup 数值设置（非数字无效） -->
    <div id="g-scroll" class="_scroll" tabindex="0"
        on="keydown|(CHK) acmsk $('#g-count') val int hotKey(_2) pass;
            keyup|(/^[\d.-]$/) ev('key') test(_1) pass $('#g-count') val ev('key') add(_1)"
        to="#g-count|trigger('reset');
            #g-count|trigger('setv')">
        <!-- 上下文菜单 -->
        <menu id="g-cmenu" class="_cmenu" tabindex="0" data-pbo="lost">
            <li data-val="minied"><b id="l-minied">修改</b><kbd>m/M/Tab</kbd></li>
            <hr>
            <!-- 300:延迟显示，400:延迟隐藏
                注：sm-1/sm-0 只是一个存储键，非用于事件绑定。 -->
            <li role="submenu" data-pbo="folded"
                on="@sm-1|evo(3) fold(0);
                    @sm-0|evo(3) fold(1);
                    mouseenter|data('tk-0') timeOut(null) evo(3) chain('sm-1') timeOut(300);
                    mouseleave|data('tk-1') timeOut(null) evo(3) chain('sm-0') timeOut(400)"
                to="-;-;
                    |data('tk-1');
                    |data('tk-0')">
                <h5><b id="l-convert">转换</b></h5>
                <menu></menu>
            </li>
            <hr>
            <li data-val="toup"><b id="l-toup">升级</b><kbd>Alt_Ctrl_←</kbd></li>
            <li data-val="todown"><b id="l-todown">降级</b><kbd>Alt_Ctrl_→</kbd></li>
            <!-- <li data-val="delete"><b id="l-delete">删除</b><kbd>d/D</kbd></li> -->
            <hr>
            <li data-val="property"><b id="l-property">属性</b><kbd>p</kbd></li>
        </menu>
        <!-- 选取创建（mouseup） -->
        <menu id="g-cells" class="_cells" tabindex="0" data-pbo="lost">
            <li data-val="a" title="<a>"><b><a href="javascript:;">链接</a></b><kbd>a</kbd></li>
            <li data-val="code" title="<code>"><b><code>代码</code></b><kbd>c</kbd></li>
            <li data-val="strong" title="<strong>"><b><strong>重点</strong></b><kbd>s</kbd></li>
            <li data-val="em" title="<em>"><b><em>强调</em></b><kbd>e</kbd></li>
            <li data-val="sup" title="上标<sup>"><b>O<sup>2</sup></b><kbd></kbd></li>
            <li data-val="sub" title="下标<sub>"><b>O<sub>2</sub></b><kbd></kbd></li>
            <li data-val="q" title="<q>"><b><q>引用</q></b><kbd>q</kbd></li>
            <li data-val="time" title="<time>"><b><time>时间</time></b><kbd>t</kbd></li>
            <li data-val="ins" title="<ins>"><b><ins>插入</ins></b><kbd>i</kbd></li>
            <li data-val="del" title="<del>"><b><del>删除</del></b><kbd>d</kbd></li>
            <li data-val="abbr" title="<abbr>"><b><abbr>缩写</abbr></b><kbd></kbd></li>
            <li data-val="small" title="<small>"><b><small>注脚</small></b><kbd></kbd></li>
            <li data-val="cite" title="<cite>"><b><cite>来源</cite></b><kbd></kbd></li>
            <li data-val="mark" title="<mark>"><b><mark>标记</mark></b><kbd>m</kbd></li>
            <li data-val="ruby" title="<ruby>">
                <b><ruby>
                    <rb>注音</rb>
                    <rp>(</rp><rt>zhù yīn</rt><rp>)</rp>
                </ruby></b>
                <kbd>r</kbd>
            </li>
            <li data-val="orz" title="表情<code:orz>"><b><code role="orz">(^_^)</code></b><kbd>o</kbd></li>
            <li data-val="dfn" title="<dfn>"><b><dfn>定义条目</dfn></b><kbd>f</kbd></li>
            <li data-val="samp" title="<samp>"><b><samp>样本</samp></b><kbd>p</kbd></li>
            <li data-val="kbd" title="<kbd>"><b><kbd>键盘字</kbd></b><kbd>k</kbd></li>
            <li data-val="s" title="<s>"><b><s>失效</s></b><kbd></kbd></li>
            <li data-val="u" title="<u>"><b><u>注记</u></b><kbd>u</kbd></li>
            <li data-val="var" title="<var>"><b><var>变量</var></b><kbd>v</kbd></li>
            <li data-val="bdo" title="<bdo>"><b><bdo dir="rtl">有向文本</bdo></b><kbd>b</kbd></li>
        </menu>
        <!-- 内容区 -->
        <!-- 微编辑：on="mouseup keyup input|rangeKeep stop" -->
        <main id="content" class="content"
            on="click(*)|evo(1) scam;
                @mouseover:1|('_point');
                @mouseout:1|('_point');
                mouseover(*)|$('#g-count') val end evo(1) einfo(true) str('<', '>');
                mouseleave|$('#g-count') val end;
                cancel|stop (Kit) call('selsEmpty');
                ^obted"
            by="Ed.click(_1)"
            to="#g-count|trigger('reset');
                =|addClass;
                =|removeClass;
                #status-tips|trigger('info');
                #g-count|trigger('reset');
                #g-count|trigger('reset');
                |bind('mouseover:1 mouseout:1', '*')">
            <hgroup>
                <h1 id="文章内容的规范化结构">文章内容的规范化结构</h1>
                <h2>—— 简单干净的源码，清爽愉悦的阅读</h2>
            </hgroup>
            <article>
                <header>
                    <p>文章结构良好有着十分重要的意义，它不但让大纲清晰，易于理解，而且也可以让样式共享成为可能。共享样式价值不菲，它使得样式可以由专业的人员来制作，设计精美，而文章的作者也可以只专注于内容本身。</p>
                    <p>依通常的情形和需求，这里提供最多5个层级的支持，分别命名为：<strong>章</strong>、<strong>节</strong>、<strong>区</strong>、<strong>段</strong>、<strong>末</strong>。它们逐层嵌套，每一层都由一个 <code>&lt;section&gt;</code> 封装，为便于识别和定位，<code>&lt;section&gt;</code> 元素上分别定义 <code>role</code> 属性值为：<code>s1 ~ s5</code>。</p>
                </header>
                <section role="s1">
                    <h2 id="组成">组成</h2>
                    <section role="s2">
                        <h2 id="内容块">内容块</h2>
                        <header>
                            <p>独立的行块内容单元，占据单独的一行（<code>display:block</code>）。如 <code>&lt;ol&gt;</code>、<code>&lt;p&gt;</code>，前者为固定结构类单元，后者可以直接包含文本内容。</p>
                        </header>
                        <section role="s3">
                            <h2 id="结构类">结构类</h2>
                            <p>内部不能直接包含文本或内联元素，有固定的子级结构。</p>

                        </section>
                        <section role="s3">
                            <h2 id="文本类">文本类</h2>
                            <p>可直接包含文本内容和内联单元，没有固定的DOM结构可单独占据一行的块级元素。</p>
                            <pre role="codeblock"><code data-lang="html">&lt;<b role="tag">p</b>&gt;&lt;/<b role="tag">p</b>&gt;                 <i>&lt;!-- 段落：P 通用内容容器 --&gt;</i>
&lt;<b role="tag">p</b> role=<b role="str">"note"</b>&gt;&lt;/<b role="tag">p</b>&gt;     <i>&lt;!-- 注解：NOTE --&gt;</i>
&lt;<b role="tag">p</b> role=<b role="str">"tips"</b>&gt;&lt;/<b role="tag">p</b>&gt;     <i>&lt;!-- 提示：TIPS --&gt;</i>
&lt;<b role="tag">address</b>&gt;&lt;/<b role="tag">address</b>&gt;     <i>&lt;!-- 地址信息：ADDRESS --&gt;</i>
&lt;<b role="tag">pre</b>&gt;&lt;/<b role="tag">pre</b>&gt;             <i>&lt;!-- 预排版：PRE 非代码块 --&gt;</i>
</code></pre>
                        </section>
                        <section role="s3">
                            <h2 id="单体类">单体类</h2>
                            <p>不包含任何内容，是一个独立存在的单元。</p>
                            <pre role="codeblock"><code data-lang="html">&lt;<b role="tag">hr</b> /&gt;                      <i>&lt;!-- 分隔：HR --&gt;</i>
&lt;<b role="tag">div</b> role=<b role="str">"blank"</b>&gt;&lt;/<b role="tag">div</b>&gt;    <i>&lt;!-- 白板：BLANK 用于交互展示 --&gt;</i>
</code></pre>
                            <aside>
                                <p><strong>注：</strong> 白板可插入内容，但仅适用在运行时下且应当是临时的。</p>
                            </aside>
                        </section>
                    </section>
                    <section role="s2">
                        <h2 id="内容件">内容件</h2>
                        <p>可直接作为文章正文内容的内容块被称为 <strong>内容件</strong>，上面的文本类内容块和除了顶层 <strong>提要</strong>、<strong>目录</strong> 等少数几个单元的结构类内容块都可以作为正文内容，它们都是内容件。</p>
                    </section>
                    <section role="s2">
                        <h2 id="内容行和内容元素">内容行和内容元素</h2>
                        <p>可直接包含文本和内联元素的行级元素，上面的文本类内容件就是 <strong>内容行</strong>。但内容行还包括不能单独作为内容的行元素，如 <code>&lt;li&gt;</code>、<code>&lt;caption&gt;</code>、<code>&lt;dt&gt;</code>、<code>&lt;dd&gt;</code> 等。</p>
                        <p><strong>内容元素</strong> 是所有可以直接包含文本和其它内联元素的元素。上面的内容行是内容元素，但还有其它非行级的元素也可以直接包含文本，如 <code>&lt;td&gt;</code>、<code>&lt;strong&gt;</code>、<code>&lt;small&gt;</code> 等，前者是表格的内容单元，而后两者则是内联元素。</p>
                    </section>
                    <section role="s2">
                        <h2 id="内联单元">内联单元</h2>
                        <p>只能被包含在内容元素里的元素，没有行块的逻辑，有时也称为行内元素。其中既有可以包含文本的内容元素，也有结构性元素，如文本类的 <ruby><rb>注音</rb><rp>(</rp><rt>zhù yīn</rt><rp>)</rp></ruby>、或媒体类的 <code>&lt;img&gt;</code>、<code>&lt;audio&gt;</code> 等。</p>
                        <p>内联单元不是 <strong>内容件</strong>，它们不能作为片区（<code>&lt;section&gt;</code>）的直接子元素出现，必须被行块级的内容行元素（如 <code>&lt;p&gt;</code>、<code>&lt;address&gt;</code> 等）封装才行。</p>
                        <table border="1">
                            <caption>内联单元基本情况清单</caption>
                            <thead>
                                <tr>
                                    <th>名称</th>
                                    <th>标签</th>
                                    <th>类型/结构</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>音频</th>
                                    <td>&lt;audio&gt;&lt;/audio&gt;</td>
                                    <td>AUDIO /track,source, #text</td>
                                </tr>
                                <tr>
                                    <th>视频</th>
                                    <td>&lt;video&gt;&lt;/video&gt;</td>
                                    <td>VIDEO /track,source, #text</td>
                                </tr>
                                <tr>
                                    <th>图片</th>
                                    <td>&lt;picture&gt;&lt;/picture&gt;</td>
                                    <td>PICTURE /source,img</td>
                                </tr>
                                <tr>
                                    <th>链接</th>
                                    <td>&lt;a&gt;&lt;/a&gt;</td>
                                    <td>A</td>
                                </tr>
                                <tr>
                                    <th>重点</th>
                                    <td>&lt;strong&gt;&lt;/strong&gt;</td>
                                    <td>STRONG</td>
                                </tr>
                                <tr>
                                    <th>强调</th>
                                    <td>&lt;em&gt;&lt;/em&gt;</td>
                                    <td>EM</td>
                                </tr>
                                <tr>
                                    <th>短引用</th>
                                    <td>&lt;q&gt;&lt;/q&gt;</td>
                                    <td>Q</td>
                                </tr>
                                <tr>
                                    <th>缩写</th>
                                    <td>&lt;abbr&gt;&lt;/abbr&gt;</td>
                                    <td>ABBR</td>
                                </tr>
                                <tr>
                                    <th>来源</th>
                                    <td>&lt;cite&gt;&lt;/cite&gt;</td>
                                    <td>CITE</td>
                                </tr>
                                <tr>
                                    <th>注脚</th>
                                    <td>&lt;small&gt;&lt;/small&gt;</td>
                                    <td>SMALL</td>
                                </tr>
                                <tr>
                                    <th>时间</th>
                                    <td>&lt;time&gt;&lt;/time&gt;</td>
                                    <td>TIME</td>
                                </tr>
                                <tr>
                                    <th>删除</th>
                                    <td>&lt;del&gt;&lt;/del&gt;</td>
                                    <td>DEL</td>
                                </tr>
                                <tr>
                                    <th>插入</th>
                                    <td>&lt;ins&gt;&lt;/ins&gt;</td>
                                    <td>INS</td>
                                </tr>
                                <tr>
                                    <th>下标</th>
                                    <td>&lt;sub&gt;&lt;/sub&gt;</td>
                                    <td>SUB</td>
                                </tr>
                                <tr>
                                    <th>上标</th>
                                    <td>&lt;sup&gt;&lt;/sup&gt;</td>
                                    <td>SUP</td>
                                </tr>
                                <tr>
                                    <th>标记</th>
                                    <td>&lt;mark&gt;&lt;/mark&gt;</td>
                                    <td>MARK</td>
                                </tr>
                                <tr>
                                    <th>代码</th>
                                    <td>&lt;code data-lang=".."&gt;&lt;/code&gt;</td>
                                    <td>CODE，可定义语言</td>
                                </tr>
                                <tr>
                                    <th>表情</th>
                                    <td>&lt;code role="orz"&gt;&lt;/code&gt;</td>
                                    <td>ORZ</td>
                                </tr>
                                <tr>
                                    <th>注音</th>
                                    <td>&lt;ruby&gt;&lt;/ruby&gt;</td>
                                    <td>RUBY /rb,rp,rt</td>
                                </tr>
                                <tr>
                                    <th>定义</th>
                                    <td>&lt;dfn&gt;&lt;/dfn&gt;</td>
                                    <td>DFN</td>
                                </tr>
                                <tr>
                                    <th>样本</th>
                                    <td>&lt;samp&gt;&lt;/samp&gt;</td>
                                    <td>SAMP</td>
                                </tr>
                                <tr>
                                    <th>键盘字</th>
                                    <td>&lt;kbd&gt;&lt;/kbd&gt;</td>
                                    <td>KBD</td>
                                </tr>
                                <tr>
                                    <th>失效</th>
                                    <td>&lt;s&gt;&lt;/s&gt;</td>
                                    <td>S</td>
                                </tr>
                                <tr>
                                    <th>注记</th>
                                    <td>&lt;u&gt;&lt;/u&gt;</td>
                                    <td>U</td>
                                </tr>
                                <tr>
                                    <th>变量</th>
                                    <td>&lt;var&gt;&lt;/var&gt;</td>
                                    <td>VAR</td>
                                </tr>
                                <tr>
                                    <th>有向文本</th>
                                    <td>&lt;bdo&gt;&lt;/bdo&gt;</td>
                                    <td>BDO</td>
                                </tr>
                                <tr>
                                    <th>度量</th>
                                    <td>&lt;meter&gt;&lt;/meter&gt;</td>
                                    <td>METER</td>
                                </tr>
                                <tr>
                                    <th>图片</th>
                                    <td>&lt;img /&gt;</td>
                                    <td>IMG</td>
                                </tr>
                                <tr>
                                    <th>换行</th>
                                    <td>&lt;br /&gt;</td>
                                    <td>BR</td>
                                </tr>
                                <tr>
                                    <th>软换行</th>
                                    <td>&lt;wbr /&gt;</td>
                                    <td>WBR</td>
                                </tr>
                                <tr>
                                    <th>空白</th>
                                    <td>&lt;span role="blank"&gt;&lt;/span&gt;</td>
                                    <td>SPACE</td>
                                </tr>
                                <tr>
                                    <th>特用</th>
                                    <td>&lt;b&gt;</td>
                                    <td>代码关键字封装</td>
                                </tr>
                                <tr>
                                    <th>特用</th>
                                    <td>&lt;i&gt;</td>
                                    <td>代码注释/标题编号</td>
                                </tr>
                                <tr>
                                    <th>文本节点</th>
                                    <td>#text</td>
                                    <td>$text</td>
                                </tr>
                            </tbody>
                        </table>
                        <p>空白行……</p>
                    </section>
                </section>
            </article>
        </main>
    </div>
    <!-- 元素路径
        - toggle 快捷键隐显切换。
        - varyempty 鼠标停留路径单元时，键盘移动焦点会有指向残留，清除之。-->
    <div id="g-path" class="_path"
        on="click(b)|(Kit) evo(2) call('pathElem', _1) scam;
            mouseenter(b)|('_point') (Kit) evo(2) call('pathElem', _1) pop;
            mouseleave(b)|stop ('_point') (Kit) evo(2) call('pathElem', _1) pop;
            varyempty;
            toggle|evo(3) hide(2)"
        by="Ed.pathTo(_1)"
        to="#g-count|trigger('reset')|fire('body/', 'focus.content');
            -|addClass;
            -|removeClass;
            /b:hover|trigger('mouseleave', true)">
        <!-- <b> -->
    </div>
</div>


<!-- 主面板：
    - mousedown 面板高度调整。
    - keydown   面板快捷键处理。
    - scroll    背景/行线跟随 -->
<div id="main-slave" class="___Panel Slave" tpl-name="main:slave"
    on="@mousemove|movementY neg avoid;
        @mouseup|movementY(null);
        mousedown|scam(KM.slaveResize) pass stop;
        scroll(textarea)|evo(2) scrollTop neg add('px');
        input.full(~textarea)|evo(2) full(2);
        keydown|(SHK) acmsk ev('key') hotKey(_2) pop stop"
    to="|height(true);
        |off('mousemove');
        |bind('mousemove') once('mouseup');
        =|%backgroundPositionY">
    <div class="_tabs"
        on="click(b)|evo(2) attr('-tpl') pop tpl;
            click(b)|evo(2) hasClass('_press') end $$('/b')"
        to="1/form|replace;
            =|only('_press')">
        <b data-tpl="slave:input" class="_press">内容</b>
        <b data-tpl="slave:style">样式</b>
        <b data-tpl="slave:attr">特性</b>
        <b data-tpl="slave:source">源码</b>
        <b data-tpl="slave:script">脚本</b>
        <b class="_close"
            on="click|stop"
            to="#b-slave||click">
            <i id="l-close" title="关闭"></i>
        </b>
    </div>
    <form tpl-source="slave:input"> [内容面板] </form>
    <!-- <form tpl-source="slave:minied"> [微编辑面板] </form> -->
</div>


<!-- 状态栏 -->
<div class=" ___Panel Status" tpl-name="main:status">
    <!-- 提示区 -->
    <div class="_tips">
        <span id="status-tips" title=""
            on="info|ev('detail')"
            to="|attribute('title text')"></span>
        <!--计数暂存
            reset: 清空值，提供选取集大小默认显示。
            setv:  设置值并提供该值的显示。-->
        <input id="g-count" name="count" type="hidden"
            on="reset|(Kit) call('esetSize') str('[ ', ' ]') ('');
                setv|(ESC) evo(3) apply('add', _1) ev('detail') dup;
                cancel|(ESC) apply('pop')"
            to="|val|pop fire('#status-tips', 'info');
                |val|pop fire('#status-tips', 'info');
                |trigger('reset')" />
    </div>
    <!-- 指令符 -->
    <div class="_cmdx">
        <span class="_code" tabindex="0" data-pbo="lost"
            on="click(b)|evo(1) text;
                blur|evo(3) lose"
            to="1/code|trigger('setv')">
            <b title="选择器模式">/</b>
            <b title="选取集过滤">|</b>
            <b title="文本搜索">?</b>
            <b title="普通命令">:</b>
            <b title="简单计算">=</b>
            <b title="扩展指令...">!</b>
        </span>
        <!-- data-v: CSS辅助 -->
        <code id="g-cmdx" data-v="/"
            on="setv|ev('detail') dup;
                done|$('1/span') lose;
                click|$('1/span') dup lose(0) focus"
            to="|@text @-v|goto('done');
                #cmd-input|-|focus">/</code>
    </div>
    <!-- 命令行 -->
    <div class="_cmdline">
        <!-- 交互：
            1. 回车执行命令行，自动选取结果。
            2. Tab键展开当前键入内容匹配清单。
            3. 上下箭头和翻页键匹配当前键入词导航。
            4. Ctrl+U 清空命令行内容。
            5. 手动键入内容为搜索历史匹配。
            6. Tab和箭头翻页导航支持+Shift模糊匹配。
        -->
        <input id="cmd-input" type="text" spellcheck="false" class="_code" value="" />
    </div>
    <!-- 出错信息区 -->
    <div id="g-errmsg" class="_err" data-pbo=""
        on="on|evo(3) lose(1);
            off|evo(3) lose">
        <a data-hid="" title=""
            on="setv|ev('detail')"
            to="|attribute('-hid title text')">[单击将在帮助框里显示详细信息]</a>
    </div>
    <!-- 帮助入口 -->
    <div id="x-help" class="_help" title="帮助"
        on="toggle|$$('#help,#lineRight') lose(2) ('_press');
            click"
        to="|toggleClass;
            |trigger('toggle')|fire('body', 'pcheck')">
        <code>?</code>
    </div>
</div>
