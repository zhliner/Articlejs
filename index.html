<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="no-cache">
<title>Coolj-ED编辑器在线版</title>
<link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="styles.css">
<script src="base/tquery/tquery.min.js"></script>
<script type="module">
    import coolj from "./editor.js";
    import { saveEditor } from "./index.js";

    let _ebox = $.get( '#editorBox' ),
        _fun2 = [ $.removeClass, $.addClass ],
        _opts = {
            onsaved: html => window.console.info(html),
            onmaximize: num => _fun2[ num ]( _ebox, '_full' ),
        };

    coolj.create( _opts )
        .load( _ebox )
        // .then( ed => coolj.recoverStyles(ed) && saveEditor(ed) )
        .then( ed => saveEditor(ed) )
        .then( ed => ed.frame().contentWindow.focus() );
</script>
<!-- Tpb支持 -->
<script type="module" src="./index.js"></script>
</head>
<body>
    <main>
        <h1>◡酷几◡编辑器在线版</h1>
        <nav
            on="click(>b)|evo(1) attr('-file')"
            by="GET('text', _1) fragment pop $('/main.content') children not('nav')"
            to="1/iframe|trigger('cimport')">
            <b title="单击导入" data-file="docs/intro.html">简介</b>
            <b title="单击导入" data-file="docs/manual.html">操作手册</b>
            <b title="单击导入" data-file="docs/article.html">文章结构规范</b>
            <span>
                <label>主题</label>
                <select name="themes"
                    on="change|evo(3) val themeURL"
                    by="Kit.style('theme')"
                    to="#editorBox|trigger('active')">
                    <option value="Example">模板样例</option>
                    <option value="The-blue">蓝调的传说</option>
                    <option value="Classic-gray">经典50度灰</option>
                    <option value="Dark-less">光明之夜</option>
                </select>
                <a title="主题制作包" href="docs/theme2pack.zip">?</a>
            </span>
            <span>
                <label>内容样式</label>
                <select name="styles"
                    on="change|evo(3) val dup pop(2) codesURL mainURL"
                    by="Kit.style('style') Kit.style('codes')"
                    to="#editorBox|trigger('active')">
                    <option value="example">模板样例</option>
                    <option value="nostalgia">乡愁</option>
                    <option value="paleness">平庸的白暮</option>
                    <option value="wildwide">旷野无垠</option>
                </select>
                <a title="内容样式制作包" href="docs/style2pack.zip">?</a>
            </span>
        </nav>
        <form onsubmit="return false" action="">
            <textarea name="content" style="display: none;"></textarea>
            <!-- active 激活：向内聚焦便于快捷键操作。 -->
            <span id="editorBox"
                on="active|$('/iframe') its('contentWindow') pop"
                to="-|apply('focus')"><!-- 编辑器容器 --></span>
        </form>
    </main>
</body>
</html>
